<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Summation-by-Parts Operators · DispersiveShallowWater.jl</title><meta name="title" content="Summation-by-Parts Operators · DispersiveShallowWater.jl"/><meta property="og:title" content="Summation-by-Parts Operators · DispersiveShallowWater.jl"/><meta property="twitter:title" content="Summation-by-Parts Operators · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/SBP_Operators/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/SBP_Operators/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/SBP_Operators/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../basic_example/">Basic Example</a></li><li class="is-active"><a class="tocitem" href>Summation-by-Parts Operators</a><ul class="internal"><li><a class="tocitem" href="#1.-Introduction-and-Overview"><span>1. Introduction &amp; Overview</span></a></li><li><a class="tocitem" href="#2.-Mathematical-Foundation"><span>2. Mathematical Foundation</span></a></li><li><a class="tocitem" href="#3.-Types-of-SBP-Operators"><span>3. Types of SBP Operators</span></a></li></ul></li><li><a class="tocitem" href="../solvers/">Using different Solvers</a></li><li><a class="tocitem" href="../callbacks/">Callbacks and Relaxation</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../dingemans/">Experimental Data</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../ref-trixibase/">TrixiBase</a></li><li><a class="tocitem" href="../ref/">DispersiveShallowWater</a></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Summation-by-Parts Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Summation-by-Parts Operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/SBP_Operators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="sbp_operates"><a class="docs-heading-anchor" href="#sbp_operates">Summation-by-Parts Operators</a><a id="sbp_operates-1"></a><a class="docs-heading-anchor-permalink" href="#sbp_operates" title="Permalink"></a></h1><p>This chapter covers the analytical and mathematical background of summation-by-parts operators in general.</p><p>To learn more about different solvers and how to use them in DispersiveShallowWater.jl, go to the chapter about <a href="../solvers/#solvers">Solvers</a>.</p><h2 id="1.-Introduction-and-Overview"><a class="docs-heading-anchor" href="#1.-Introduction-and-Overview">1. Introduction &amp; Overview</a><a id="1.-Introduction-and-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Introduction-and-Overview" title="Permalink"></a></h2><p>In recent years, summation-by-parts (SBP) operators have gained particular interest in computational mathematics as they allow transferring analytical results from the continuous level to numerical methods in a systematic manner. This is achieved by mimicking integration by parts discretely, which is one of the key ingredients for conservation and stability proofs at the continuous level. In this way, many fundamental analytical properties of hyperbolic-dominated partial differential equations can be obtained in a straightforward manner at the discrete level.<sup class="footnote-reference"><a id="citeref-LampertRanocha2024" href="#footnote-LampertRanocha2024">[LampertRanocha2024]</a></sup></p><p>SBP operators were first developed for finite difference methods to mimic stability proofs based on integration by parts as traditionally used in finite element methods. However, exact integration can be impossible or computationally expensive in finite element methods, particularly for complex geometries or nonlinear problems. In this case, SBP formulations can be advantageous since they naturally include a quadrature rule through the mass matrix. In particular, split forms can be used with SBP operators to avoid the need for exact integration while maintaining discrete analogs of important analytical properties such as the chain rule and product rule.</p><p>Several classes of numerical methods can be formulated via SBP operators, including finite difference methods, finite volume methods, continuous Galerkin methods, discontinuous Galerkin (DG) methods, and flux reconstruction methods. This unifying framework has made SBP operators a cornerstone of structure-preserving numerical methods across various computational disciplines.</p><h3 id="Why-SBP-Operators-Matter-for-Dispersive-Shallow-Water-Equations"><a class="docs-heading-anchor" href="#Why-SBP-Operators-Matter-for-Dispersive-Shallow-Water-Equations">Why SBP Operators Matter for Dispersive Shallow Water Equations</a><a id="Why-SBP-Operators-Matter-for-Dispersive-Shallow-Water-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Why-SBP-Operators-Matter-for-Dispersive-Shallow-Water-Equations" title="Permalink"></a></h3><p>For dispersive shallow water equations implemented in DispersiveShallowWater.jl, maintaining physical properties like mass and energy conservation is crucial for:</p><ul><li><strong>Long-time stability</strong>: Simulations remain stable over extended time periods without spurious growth of numerical errors</li><li><strong>Physical accuracy</strong>: The discrete solution respects fundamental physical laws such as conservation of mass, momentum, and energy</li><li><strong>Robustness</strong>: Methods are less sensitive to parameter choices and grid resolution, leading to more reliable simulations</li></ul><p>SBP operators achieve this by providing:</p><ul><li><strong>Exact conservation</strong>: Discrete conservation laws that hold to machine precision</li><li><strong>Provable stability</strong>: Mathematical guarantees about the behavior of the numerical method through discrete energy estimates</li><li><strong>Flexibility</strong>: A unified framework that encompasses finite differences, finite elements, and spectral methods</li></ul><h2 id="2.-Mathematical-Foundation"><a class="docs-heading-anchor" href="#2.-Mathematical-Foundation">2. Mathematical Foundation</a><a id="2.-Mathematical-Foundation-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Mathematical-Foundation" title="Permalink"></a></h2><h3 id="The-Core-SBP-Property"><a class="docs-heading-anchor" href="#The-Core-SBP-Property">The Core SBP Property</a><a id="The-Core-SBP-Property-1"></a><a class="docs-heading-anchor-permalink" href="#The-Core-SBP-Property" title="Permalink"></a></h3><p>The fundamental property that defines a first-derivative SBP operator is:</p><p class="math-container">\[MD + D^T M = t_R t_R^T - t_L t_L^T\]</p><p>where:</p><ul><li><span>$D$</span> is the derivative operator (matrix)</li><li><span>$M$</span> is the symmetric, positive definite mass matrix</li><li><span>$\boldsymbol{e}_L = (1,0,...,0)^T$</span> and <span>$\boldsymbol{e}_R = (0,...,0,1)^T$</span> extract boundary values</li></ul><p>This property is the discrete analog of integration by parts:</p><p>$</p><p>\begin{equation<em>}         \begin{array}{ccccccc}             \underbrace{\bm u^TMD<em>1\bm v}</em>{\approx} &amp;+&amp; \underbrace{\bm u^TD<em>1^TM\bm v}</em>{\approx} &amp;=&amp; \underbrace{\bm u^T\bm e<em>R\bm e</em>R^T\bm v}<em>{=} &amp;-&amp; \underbrace{\bm u^T\bm e</em>L\bm e<em>L^T\bm v}</em>{=}\
            \overbrace{\displaystyle\int<em>\Omega uv</em>x \textrm dx} &amp;+&amp; \overbrace{\displaystyle\int<em>\Omega u</em>xv \textrm dx} &amp;=&amp; \overbrace{u(x<em>{\text{max}})v(x</em>{\text{max}})} &amp;-&amp; \overbrace{u(x<em>{\text{min}})v(x</em>{\text{min}})}.         \end{array}     \end{equation</em>} $</p><p class="math-container">\[MD + D^T M = 0.\]</p><h3 id="Understanding-the-Mass-Matrix"><a class="docs-heading-anchor" href="#Understanding-the-Mass-Matrix">Understanding the Mass Matrix</a><a id="Understanding-the-Mass-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-the-Mass-Matrix" title="Permalink"></a></h3><p>The mass matrix <span>$M$</span> approximates the continuous inner product:</p><p class="math-container">\[\langle \boldsymbol{u}, \boldsymbol{v} \rangle_M = \boldsymbol{u}^T M \boldsymbol{v} \approx \int_{x_{min}}^{x_{max}} u(x) v(x) dx\]</p><p>For the approximation to be meaningful, we require:</p><p class="math-container">\[\boldsymbol{1}^T M \boldsymbol{1} = x_{\max} - x_{\min}\]</p><p>This ensures that the discrete inner product correctly integrates constants.</p><h3 id="Understanding-the-Derivative-Operator"><a class="docs-heading-anchor" href="#Understanding-the-Derivative-Operator">Understanding the Derivative Operator</a><a id="Understanding-the-Derivative-Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-the-Derivative-Operator" title="Permalink"></a></h3><p>The derivative operator <span>$D$</span> approximates the spatial derivative of a function on a discrete grid. That is, for a smooth function <span>$u(x)$</span>, we want the discrete expression <span>$D \boldsymbol{u}$</span> to approximate <span>$\partial_x u(x)$</span> at the grid points.</p><p>A first-derivative SBP operator is said to be <strong><span>$p$</span>-th order accurate</strong> if it satisfies:</p><p class="math-container">\[D\, \boldsymbol{x}^k = k\, \boldsymbol{x}^{k-1}, \quad \text{for all } k = 0, 1, ..., p,\]</p><p>where <span>$\boldsymbol{x}^k = (x_1^k, \dots, x_N^k)^T$</span>. This means the discrete operator correctly differentiates monomials up to degree <span>$p$</span>. In particular, <strong>consistency</strong> requires at least zeroth-order accuracy, i.e.,</p><p class="math-container">\[D\, \boldsymbol{1} = \boldsymbol{0}.\]</p><p>However, approximating derivatives near boundaries poses a challenge: interior points can use standard finite difference stencils, but near the edges (e.g., at <code>x_1</code> or <code>x_N</code>), one must use specially designed one-sided approximations that still preserve stability and accuracy. Periodic SBP Operators do not have this problem.</p><h3 id="Example:-Central-Difference-Operator"><a class="docs-heading-anchor" href="#Example:-Central-Difference-Operator">Example: Central Difference Operator</a><a id="Example:-Central-Difference-Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Central-Difference-Operator" title="Permalink"></a></h3><p>A simple example is the classical second-order central difference operator on a uniform grid:</p><p class="math-container">\[D = \frac{1}{\Delta x} \begin{pmatrix}
-1 &amp; 1 &amp; &amp; &amp; \\
-1/2 &amp; 0 &amp; 1/2 &amp; &amp; \\
&amp; -1/2 &amp; 0 &amp; 1/2 &amp; \\
&amp; &amp; \ddots &amp; \ddots &amp; \ddots \\
&amp; &amp; &amp; -1 &amp; 1
\end{pmatrix}\]</p><p>with mass matrix:</p><p class="math-container">\[M = \Delta x \cdot \text{diag}(1/2, 1, 1, \ldots, 1, 1/2)\]</p><p>You can verify that this satisfies the SBP property and provides second-order accuracy in the interior with first-order accuracy at the boundaries.</p><h2 id="3.-Types-of-SBP-Operators"><a class="docs-heading-anchor" href="#3.-Types-of-SBP-Operators">3. Types of SBP Operators</a><a id="3.-Types-of-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Types-of-SBP-Operators" title="Permalink"></a></h2><p>In practice SBP operators come in various <em>flavours</em>. </p><p>upwind vs. central vs. FD vs. DG vs. CG vs. Fourier</p><h3 id="Central-vs.-Upwind-SBP-Operators"><a class="docs-heading-anchor" href="#Central-vs.-Upwind-SBP-Operators">Central vs. Upwind SBP Operators</a><a id="Central-vs.-Upwind-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Central-vs.-Upwind-SBP-Operators" title="Permalink"></a></h3><p>The choice between central and upwind SBP operators is crucial and depends on the nature of your problem.</p><h4 id="Central-SBP-Operators"><a class="docs-heading-anchor" href="#Central-SBP-Operators">Central SBP Operators</a><a id="Central-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Central-SBP-Operators" title="Permalink"></a></h4><h4 id="upwind_sbp"><a class="docs-heading-anchor" href="#upwind_sbp">Upwind SBP Operators</a><a id="upwind_sbp-1"></a><a class="docs-heading-anchor-permalink" href="#upwind_sbp" title="Permalink"></a></h4><p>Upwind operators come in pairs <span>$D_+$</span> and <span>$D_-$</span> with additional dissipation:</p><ul><li><strong>Key Property</strong>: <span>$M(D_+ - D_-)$</span> is negative semidefinite (provides controlled dissipation)</li><li><strong>Major Advantage</strong>: <strong>Higher resolution</strong> - better at resolving sharp features</li><li><strong>Construction</strong>: <span>$D = (D_+ + D_-)/2$</span> gives a central operator</li></ul><h4 id="Why-Upwind-Operators-Have-Higher-Resolution"><a class="docs-heading-anchor" href="#Why-Upwind-Operators-Have-Higher-Resolution">Why Upwind Operators Have Higher Resolution</a><a id="Why-Upwind-Operators-Have-Higher-Resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Upwind-Operators-Have-Higher-Resolution" title="Permalink"></a></h4><p>The resolution advantage comes from the stencil structure. Consider discretizing a second derivative:</p><p><strong>Central approach</strong>:</p><p class="math-container">\[(D^2 u)_i \approx \frac{u_{i+2} - 2u_i + u_{i-2}}{4\Delta x^2} \quad \text{[Wide stencil!]}\]</p><p>This wide stencil has <strong>grid oscillations</strong> of the form <span>$(-1,+1,-1,+1,\ldots)$</span> in its null space.</p><p><strong>Upwind approach</strong>:</p><p class="math-container">\[(D^2 u)_i \approx \frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} \quad \text{[Narrow stencil!]}\]</p><p>The narrow stencil naturally damps high-frequency oscillations, leading to <strong>better resolution</strong>.</p><h3 id="Different-SBP-Implementations"><a class="docs-heading-anchor" href="#Different-SBP-Implementations">Different SBP Implementations</a><a id="Different-SBP-Implementations-1"></a><a class="docs-heading-anchor-permalink" href="#Different-SBP-Implementations" title="Permalink"></a></h3><h4 id="Finite-Difference-(FD)-SBP"><a class="docs-heading-anchor" href="#Finite-Difference-(FD)-SBP">Finite Difference (FD) SBP</a><a id="Finite-Difference-(FD)-SBP-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Difference-(FD)-SBP" title="Permalink"></a></h4><h4 id="dg_sbp"><a class="docs-heading-anchor" href="#dg_sbp">Discontinuous Galerkin (DG) SBP</a><a id="dg_sbp-1"></a><a class="docs-heading-anchor-permalink" href="#dg_sbp" title="Permalink"></a></h4><h4 id="Continuous-Galerkin-(CG)-SBP"><a class="docs-heading-anchor" href="#Continuous-Galerkin-(CG)-SBP">Continuous Galerkin (CG) SBP</a><a id="Continuous-Galerkin-(CG)-SBP-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-Galerkin-(CG)-SBP" title="Permalink"></a></h4><h4 id="fourier_sbp"><a class="docs-heading-anchor" href="#fourier_sbp">Fourier/Spectral SBP</a><a id="fourier_sbp-1"></a><a class="docs-heading-anchor-permalink" href="#fourier_sbp" title="Permalink"></a></h4><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-LampertRanocha2024"><a class="tag is-link" href="#citeref-LampertRanocha2024">LampertRanocha2024</a>Lampert, Ranocha (2024): Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://arxiv.org/abs/2402.16669">arXiv: 2402.16669</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../basic_example/">« Basic Example</a><a class="docs-footer-nextpage" href="../solvers/">Using different Solvers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 13 August 2025 21:05">Wednesday 13 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
