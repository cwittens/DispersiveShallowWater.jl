<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · DispersiveShallowWater.jl</title><meta name="title" content="Overview · DispersiveShallowWater.jl"/><meta property="og:title" content="Overview · DispersiveShallowWater.jl"/><meta property="twitter:title" content="Overview · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/overview/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/overview/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/overview/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#eq_overview"><span>Supported Models and Features</span></a></li><li><a class="tocitem" href="#Benjamin-Bona-Mahony-(BBM)"><span>Benjamin-Bona-Mahony (BBM)</span></a></li><li><a class="tocitem" href="#Korteweg–De-Vries-(KdV)"><span>Korteweg–De Vries (KdV)</span></a></li><li><a class="tocitem" href="#BBM-BBM"><span>BBM-BBM</span></a></li><li><a class="tocitem" href="#Svärd-Kalisch"><span>Svärd-Kalisch</span></a></li><li><a class="tocitem" href="#Serre-Green-Naghdi"><span>Serre-Green-Naghdi</span></a></li><li><a class="tocitem" href="#Hyperbolic-Serre-Green-Naghdi"><span>Hyperbolic Serre-Green-Naghdi</span></a></li></ul></li><li><a class="tocitem" href="../basic_example/">Basic Example</a></li><li><a class="tocitem" href="../SBP_Operators/">Summation-by-Parts Operators</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../solvers/">Using Different Solvers</a></li><li><a class="tocitem" href="../callbacks/">Callbacks and Relaxation</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../dingemans/">Experimental Data</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../ref-trixibase/">TrixiBase</a></li><li><a class="tocitem" href="../ref/">DispersiveShallowWater</a></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/overview.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="equations"><a class="docs-heading-anchor" href="#equations">Equations</a><a id="equations-1"></a><a class="docs-heading-anchor-permalink" href="#equations" title="Permalink"></a></h1><p>DispersiveShallowWater.jl provides six different dispersive shallow water equation systems for modeling water waves. Each equation system offers different levels of physical accuracy, computational complexity, and supports various boundary conditions and bathymetry types.</p><h2 id="eq_overview"><a class="docs-heading-anchor" href="#eq_overview">Supported Models and Features</a><a id="eq_overview-1"></a><a class="docs-heading-anchor-permalink" href="#eq_overview" title="Permalink"></a></h2><p>The following table provides an overview of all available equation systems and their supported features:</p><table><tr><th style="text-align: right">Equation</th><th style="text-align: center">Variables</th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.boundary_condition_periodic">Periodic boundary conditions</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.boundary_condition_reflecting">Reflecting boundary conditions</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.bathymetry_flat">Flat Bathymetry</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.bathymetry_mild_slope">Mild-slope Bathymetry</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.bathymetry_variable">Variable Bathymetry</a></th><th style="text-align: center">Relaxation</th><th style="text-align: center">Source Terms</th></tr><tr><td style="text-align: right"><a href="#DispersiveShallowWater.KdVEquation1D"><code>KdV</code></a></td><td style="text-align: center"><span>$(\eta)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="#DispersiveShallowWater.BBMEquation1D"><code>BBM</code></a></td><td style="text-align: center"><span>$(\eta)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="#DispersiveShallowWater.BBMBBMEquations1D"><code>BBM-BBM</code></a></td><td style="text-align: center"><span>$(\eta, v, D)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>Svärd-Kalisch</code></a></td><td style="text-align: center"><span>$(\eta, v, D)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅ᵃ</td><td style="text-align: center">❌</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>Serre-Green-Naghdi</code></a></td><td style="text-align: center"><span>$(\eta, v, D)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>Hyperbolic SGN</code></a></td><td style="text-align: center"><span>$(\eta, v, D, w, H)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr></table><p><em>ᵃReflecting boundary conditions for Svärd-Kalisch equations require <code>alpha = gamma = 0</code></em></p><h3 id="Variable-Descriptions"><a class="docs-heading-anchor" href="#Variable-Descriptions">Variable Descriptions</a><a id="Variable-Descriptions-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-Descriptions" title="Permalink"></a></h3><ul><li><span>$\eta$</span>: Total water height</li><li><span>$v$</span>: Velocity in horizontal direction  </li><li><span>$D$</span>: Still-water depth</li><li><span>$w$</span>: Auxiliary variable in hyperbolic approximation (<span>$\approx -h v_x$</span>)</li><li><span>$H$</span>: Auxiliary variable in hyperbolic approximation (<span>$\approx h$</span>)</li></ul><h3 id="Detailed-Documentation"><a class="docs-heading-anchor" href="#Detailed-Documentation">Detailed Documentation</a><a id="Detailed-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-Documentation" title="Permalink"></a></h3><p>Each equation system below includes its complete mathematical formulation, physical background, implementation details, conservation properties, and relevant literature references.</p><h2 id="Benjamin-Bona-Mahony-(BBM)"><a class="docs-heading-anchor" href="#Benjamin-Bona-Mahony-(BBM)">Benjamin-Bona-Mahony (BBM)</a><a id="Benjamin-Bona-Mahony-(BBM)-1"></a><a class="docs-heading-anchor-permalink" href="#Benjamin-Bona-Mahony-(BBM)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.BBMEquation1D" href="#DispersiveShallowWater.BBMEquation1D"><code>DispersiveShallowWater.BBMEquation1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BBMEquation1D(; gravity, D = 1.0, eta0 = 0.0, split_form = true)</code></pre><p>BBM (Benjamin–Bona–Mahony) equation in one spatial dimension. The equation is given by</p><p class="math-container">\[\begin{aligned}
  \eta_t + \sqrt{gD}\eta_x + \frac{3}{2}\sqrt{\frac{g}{D}}\eta\eta_x - \frac{1}{6}D^2\eta_{xxt} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantity of the BBM equation is the total water height <span>$\eta$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the constant bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>, where <span>$\eta_0$</span> is the constant still-water surface and <span>$D$</span> the still-water depth. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The BBM equation is only implemented for <span>$\eta_0 = 0$</span>.</p><p>The equations only support a flat bathymetry.</p><p>The BBM equation is first described in Benjamin, Bona, and Mahony (1972). The semidiscretization implemented here is developed in Ranocha, Mitsotakis, and Ketcheson (2020) for <code>split_form = true</code> and in Linders, Ranocha, and Birken (2023) for <code>split_form = false</code>. If <code>split_form</code> is <code>true</code>, a split form in the semidiscretization is used, which conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>a quadratic invariant (integral of <span>$1/2\eta(\eta - 1/6D^2\eta_{xx})$</span> or for periodic boundary conditions equivalently <span>$1/2(\eta^2 + 1/6D^2\eta_x^2)$</span>), which is called here <a href="../ref/#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a> (and <a href="../ref/#DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>entropy_modified</code></a>) because it contains derivatives of the solution</li></ul><p>for periodic boundary conditions. If <code>split_form</code> is <code>false</code> the semidiscretization conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the Hamiltonian (integral of <span>$1/4\sqrt{g/D}\eta^3 + 1/2\sqrt{gD}\eta^2$</span>) (see <a href="../ref/#DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>hamiltonian</code></a>)</li></ul><p>for periodic boundary conditions.</p><ul><li>Thomas B. Benjamin, Jerry L. Bona and John J. Mahony (1972) Model equations for long waves in nonlinear dispersive systems <a href="https://doi.org/10.1098/rsta.1972.0032">DOI: 10.1098/rsta.1972.0032</a></li><li>Hendrik Ranocha, Dimitrios Mitsotakis and David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li><li>Viktor Linders, Hendrik Ranocha and Philipp Birken (2023) Resolving entropy growth from iterative methods <a href="https://doi.org/10.1007/s10543-023-00992-w">DOI: 10.1007/s10543-023-00992-w</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/bbm_1d.jl#L1-L43">source</a></section></article><h2 id="Korteweg–De-Vries-(KdV)"><a class="docs-heading-anchor" href="#Korteweg–De-Vries-(KdV)">Korteweg–De Vries (KdV)</a><a id="Korteweg–De-Vries-(KdV)-1"></a><a class="docs-heading-anchor-permalink" href="#Korteweg–De-Vries-(KdV)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.KdVEquation1D" href="#DispersiveShallowWater.KdVEquation1D"><code>DispersiveShallowWater.KdVEquation1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KdVEquation1D(; gravity, D = 1.0, eta0 = 0.0)</code></pre><p>KdV (Korteweg-de Vries) equation in one spatial dimension. The equation is given by</p><p class="math-container">\[\begin{aligned}
  \eta_t+\sqrt{g D} \eta_x+3 / 2 \sqrt{g / D} \eta \eta_x+1 / 6 \sqrt{g D} D^2 \eta_{x x x} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantity of the KdV equation is the total water height <span>$\eta$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the constant bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>, where <span>$\eta_0$</span> is the constant still-water surface and <span>$D$</span> the still-water depth. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The KdV equation is only implemented for <span>$\eta_0 = 0$</span>.</p><p>The equations only support a flat bathymetry.</p><p>The KdV equation is first introduced by Joseph Valentin Boussinesq (1877) and rediscovered by Diederik Korteweg and Gustav de Vries in 1895.</p><p>The semidiscretization implemented here is a modification of the one proposed by Biswas, Ketcheson, Ranocha, and Schütz (2025) for the non-dimensionalized KdV equation <span>$u_t + u u_x + u_{x x x} = 0.$</span></p><p>The semidiscretization looks the following:</p><p class="math-container">\[\begin{aligned}
  \eta_t+\sqrt{g D} D_1\eta+ 1 / 2 \sqrt{g / D} \eta D_1 \eta +  1 / 2 \sqrt{g / D} D_1 \eta^2 +1 / 6 \sqrt{g D} D^2 D_3\eta &amp;= 0.
\end{aligned}\]</p><p>where <span>$D_1$</span> is a first-derivative operator, <span>$D_3$</span> a third-derivative operator, and <span>$D$</span> the still-water depth.</p><p>It conserves</p><ul><li>the total water mass (integral of <span>$\eta$</span>) as a linear invariant</li></ul><p>and if upwind operators (<span>$D_3 = D_{1,+} D_1 D_{1,-}$</span>) or wide-stencil operators (<span>$D_3 = D_1^3$</span>) are used for the third derivative, it also conserves</p><ul><li>the energy (integral of <span>$1/2\eta^2$</span>)</li></ul><p>for periodic boundary conditions.</p><ul><li>Diederik Korteweg and Gustav de Vries (1895) On the change of form of long waves advancing in a rectangular canal, and on a new type of long stationary waves <a href="https://doi.org/10.1080/14786449508620739">DOI: 10.1080/14786449508620739</a></li><li>Abhijit Biswas, David I. Ketcheson, Hendrik Ranocha and Jochen Schütz (2025) Traveling-Wave Solutions and Structure-Preserving Numerical Methods for a Hyperbolic Approximation of the Korteweg-de Vries Equation <a href="https://doi.org/10.1007/s10915-025-02898-x">DOI: 10.1007/s10915-025-02898-x</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/kdv_1d.jl#L1-L44">source</a></section></article><h2 id="BBM-BBM"><a class="docs-heading-anchor" href="#BBM-BBM">BBM-BBM</a><a id="BBM-BBM-1"></a><a class="docs-heading-anchor-permalink" href="#BBM-BBM" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.BBMBBMEquations1D" href="#DispersiveShallowWater.BBMBBMEquations1D"><code>DispersiveShallowWater.BBMBBMEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BBMBBMEquations1D(; bathymetry_type = bathymetry_variable,
                  gravity, eta0 = 0.0)</code></pre><p>BBM-BBM (Benjamin–Bona–Mahony) system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}D^2\eta_{xxt} &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}D^2v_{xxt} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantities of the BBM-BBM equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the constant bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The BBM-BBM equations are only implemented for <span>$\eta_0 = 0$</span>.</p><p>Two types of <code>bathymetry_type</code> are supported:</p><ul><li><a href="../ref/#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>: flat bathymetry (typically <span>$b = 0$</span> everywhere)</li><li><a href="../ref/#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>: general variable bathymetry</li></ul><p>For the general case of variable vathymetry the BBM-BBM equations are</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}(D^2\eta_{xt})_x &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}(D^2v_t)_{xx} &amp;= 0.
\end{aligned}\]</p><p>One reference for the BBM-BBM system can be found in Bona et al. (1998). The semidiscretization implemented here was developed for flat bathymetry in Ranocha et al. (2020) and generalized for a variable bathymetry in Lampert and Ranocha (2024). It conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total velocity (integral of <span>$v$</span>) as a linear invariant for flat bathymetry</li><li>the total energy</li></ul><p>for periodic boundary conditions (see Lampert, Ranocha). For reflecting boundary conditions, the semidiscretization conserves</p><ul><li>the total water (integral of <span>$h$</span>) as a linear invariant</li><li>the total energy.</li></ul><p>Additionally, it is well-balanced for the lake-at-rest stationary solution, see Lampert and Ranocha (2024).</p><ul><li>Jerry L. Bona, Min Chen (1998) A Boussinesq system for two-way propagation of nonlinear dispersive waves <a href="https://doi.org/10.1016/S0167-2789(97)00249-2">DOI: 10.1016/S0167-2789(97)00249-2</a></li><li>Hendrik Ranocha, Dimitrios Mitsotakis, David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li><li>Joshua Lampert, Hendrik Ranocha (2024) Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://doi.org/10.48550/arXiv.2402.16669">DOI: 10.48550/arXiv.2402.16669</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/bbm_bbm_1d.jl#L1-L53">source</a></section></article><h2 id="Svärd-Kalisch"><a class="docs-heading-anchor" href="#Svärd-Kalisch">Svärd-Kalisch</a><a id="Svärd-Kalisch-1"></a><a class="docs-heading-anchor-permalink" href="#Svärd-Kalisch" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SvaerdKalischEquations1D" href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>DispersiveShallowWater.SvaerdKalischEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SvaerdKalischEquations1D(; bathymetry_type = bathymetry_variable, gravity,
                         eta0 = 0.0, alpha = 0.0, beta = 1/3, gamma = 0.0)</code></pre><p>Dispersive system by Svärd and Kalisch (2023) in one spatial dimension. The equations for variable bathymetry are given in conservative variables by</p><p class="math-container">\[\begin{aligned}
  h_t + (hv)_x &amp;= (\hat\alpha(\hat\alpha(h + b)_x)_x)_x,\\
  (hv)_t + (hv^2)_x + gh(h + b)_x &amp;= (\hat\alpha v(\hat\alpha(h + b)_x)_x)_x + (\hat\beta v_x)_{xt} + \frac{1}{2}(\hat\gamma v_x)_{xx} + \frac{1}{2}(\hat\gamma v_{xx})_x,
\end{aligned}\]</p><p>where <span>$\hat\alpha^2 = \alpha\sqrt{gD}D^2$</span>, <span>$\hat\beta = \beta D^3$</span>, <span>$\hat\gamma = \gamma\sqrt{gD}D^3$</span>. The coefficients <span>$\alpha$</span>, <span>$\beta$</span> and <span>$\gamma$</span> are provided in dimensionless form and <span>$D = \eta_0 - b$</span> is the still-water depth and <code>eta0</code> is the still-water surface (lake-at-rest). The equations can be rewritten in primitive variables as</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x &amp;= (\hat\alpha(\hat\alpha\eta_x)_x)_x,\\
  v_t(\eta + D) - v((\eta + D)v)_x + ((\eta + D)v^2)_x + g(\eta + D)\eta_x &amp;= (\hat\alpha v(\hat\alpha\eta_x)_x)_x - v(\hat\alpha(\hat\alpha\eta_x)_x)_x + (\hat\beta v_x)_{xt} + \frac{1}{2}(\hat\gamma v_x)_{xx} + \frac{1}{2}(\hat\gamma v_{xx})_x.
\end{aligned}\]</p><p>The unknown quantities of the Svärd-Kalisch equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>.</p><p>Currently, the equations only support a general variable bathymetry, see <a href="../ref/#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>.</p><p><code>SvärdKalischEquations1D</code> is an alias for <code>SvaerdKalischEquations1D</code>.</p><p>The equations by Svärd and Kalisch are presented and analyzed in Svärd and Kalisch (2025). The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total momentum (integral of <span>$h v$</span>) as a nonlinear invariant for flat bathymetry</li><li>the total modified energy</li></ul><p>for periodic boundary conditions (see Lampert, Ranocha). Additionally, it is well-balanced for the lake-at-rest stationary solution, see Lampert and Ranocha (2024).</p><ul><li>Magnus Svärd, Henrik Kalisch (2025) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a>, <a href="https://doi.org/10.1016/j.jcp.2024.113516">DOI: 10.1016/j.jcp.2024.113516</a></li><li>Joshua Lampert, Hendrik Ranocha (2024) Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://doi.org/10.48550/arXiv.2402.16669">DOI: 10.48550/arXiv.2402.16669</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/svaerd_kalisch_1d.jl#L1-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SvärdKalischEquations1D" href="#DispersiveShallowWater.SvärdKalischEquations1D"><code>DispersiveShallowWater.SvärdKalischEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SvärdKalischEquations1D</code></pre><p>Same as <a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/svaerd_kalisch_1d.jl#L59-L63">source</a></section></article><h2 id="Serre-Green-Naghdi"><a class="docs-heading-anchor" href="#Serre-Green-Naghdi">Serre-Green-Naghdi</a><a id="Serre-Green-Naghdi-1"></a><a class="docs-heading-anchor-permalink" href="#Serre-Green-Naghdi" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SerreGreenNaghdiEquations1D" href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>DispersiveShallowWater.SerreGreenNaghdiEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SerreGreenNaghdiEquations1D(; bathymetry_type = bathymetry_variable,
                            gravity, eta0 = 0.0)</code></pre><p>Serre-Green-Naghdi system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x + p_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}.
\end{aligned}\]</p><p>The unknown quantities of the Serre-Green-Naghdi equations are the total water height <span>$\eta = h + b$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The total water height is therefore given by <span>$\eta = h + b$</span>.</p><p>Three types of <code>bathymetry_type</code> are supported:</p><ul><li><a href="../ref/#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>: flat bathymetry (typically <span>$b = 0$</span> everywhere)</li><li><a href="../ref/#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a>: variable bathymetry with mild-slope approximation</li><li><a href="../ref/#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>: general variable bathymetry</li></ul><p>For the mild-slope approximation, the Serre-Green-Naghdi equations are</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} (h^2 b_x v_t)_x - \frac{1}{2} h^2 b_x v_{tx} + \frac{3}{4} h b_x^2 v_t
    + \frac{1}{2} g (h^2)_x + g h b_x + \frac{1}{2} h (v^2)_x
    + p_x + \frac{3}{2} \frac{p}{h} b_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}
    + \frac{1}{2} h^2 v (b_x v)_x.
\end{aligned}\]</p><p>For the general case of variable bathymetry without mild-slope approximation, the Serre-Green-Naghdi equations are</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} (h^2 b_x v_t)_x - \frac{1}{2} h^2 b_x v_{tx} + h b_x^2 v_t
    + \frac{1}{2} g (h^2)_x + g h b_x + \frac{1}{2} h (v^2)_x
    + p_x + \frac{3}{2} \frac{p}{h} b_x + \psi b_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}
    + \frac{1}{2} h^2 v (b_x v)_x,\\
  \psi &amp;= \frac{1}{4} h v (b_x v)_x.
\end{aligned}\]</p><p>References for the Serre-Green-Naghdi system can be found in</p><ul><li>Serre (1953) Contribution â l&#39;étude des écoulements permanents et variables dans les canaux <a href="https://doi.org/10.1051/lhb/1953034">DOI: 10.1051/lhb/1953034</a></li><li>Green and Naghdi (1976) A derivation of equations for wave propagation in water of variable depth <a href="https://doi.org/10.1017/S0022112076002425">DOI: 10.1017/S0022112076002425</a></li></ul><p>The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total momentum (integral of <span>$h v$</span>) as a nonlinear invariant if the bathymetry is constant</li><li>the total modified energy</li></ul><p>for periodic boundary conditions (see Ranocha and Ricchiuto (2024)). Additionally, it is well-balanced for the lake-at-rest stationary solution, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/serre_green_naghdi_1d.jl#L1-L70">source</a></section></article><h2 id="Hyperbolic-Serre-Green-Naghdi"><a class="docs-heading-anchor" href="#Hyperbolic-Serre-Green-Naghdi">Hyperbolic Serre-Green-Naghdi</a><a id="Hyperbolic-Serre-Green-Naghdi-1"></a><a class="docs-heading-anchor-permalink" href="#Hyperbolic-Serre-Green-Naghdi" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D" href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HyperbolicSerreGreenNaghdiEquations1D(; bathymetry_type = bathymetry_mild_slope,
                                      gravity,
                                      eta0 = 0.0,
                                      lambda)</code></pre><p>Hyperbolic approximation of the Serre-Green-Naghdi system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x
    + \biggl( \frac{\lambda}{3} H (1 - H / h) \biggr)_x &amp;= 0,\\
  h w_t + h v w_x &amp;= \lambda (1 - H / h),\\
  H_t + H_x u &amp;= w.
\end{aligned}\]</p><p>The unknown quantities of the hyperbolized Serre-Green-Naghdi equations are the total water height <span>$\eta = h + b$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The total water height is therefore given by <span>$\eta = h + b$</span>.</p><p>There are two additional variables <span>$w \approx -h v_x$</span> and <span>$H \approx h$</span> compared to the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. In the original papers of Gavrilyuk et al., the variable <span>$H$</span> is called <span>$\eta$</span>. Here, we use <span>$\eta$</span> for the total water height and <span>$H$</span> for auxiliary variable introduced in the hyperbolic approximation.</p><div class="admonition is-info" id="Initial-conditions-526438e1a05a2f10"><header class="admonition-header">Initial conditions<a class="admonition-anchor" href="#Initial-conditions-526438e1a05a2f10" title="Permalink"></a></header><div class="admonition-body"><p>The <code>HyperbolicSerreGreenNaghdiEquations1D</code> allow two options for specifying initial conditions:</p><ol><li>Returning the full set of variables <code>q = (η, v, D, w, H)</code></li><li>Returning a reduced set of variables <code>q = (η, v, D)</code> as required for the limit system <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> of the hyperbolic approximation. The remaining variables <code>w</code> and <code>H</code> are initialized using the default initialization <span>$w \approx -h v_x$</span> and <span>$H \approx h$</span> using the derivative operator of the <code>solver</code>.</li></ol></div></div><p>The relaxation parameter <code>lambda</code> (<span>$\lambda$</span>) introduced to obtain this hyperbolic approximation of the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> influences the stiffness of the system. For <span>$\lambda \to \infty$</span>, the hyperbolic Serre-Green-Naghdi equations converge (at least formally) to the original <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. However, the wave speeds of the hyperbolic system increase with increasing <span>$\lambda$</span>, so that explicit time integration methods become more expensive.</p><p>Two types of <code>bathymetry_type</code> are supported:</p><ul><li><a href="../ref/#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>: flat bathymetry (typically <span>$b = 0$</span> everywhere)</li><li><a href="../ref/#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a>: variable bathymetry with mild-slope approximation</li></ul><p>For the mild-slope approximation, the Serre-Green-Naghdi equations are</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x
    + \biggl( \frac{\lambda}{3} H (1 - H / h) \biggr)_x
    + \biggl( g h + \frac{\lambda}{2} (1 - H / h) \biggr) b_x &amp;= 0,\\
  h w_t + h v w_x &amp;= \lambda (1 - H / h),\\
  H_t + H_x u + \frac{3}{2} b_x v &amp;= w.
\end{aligned}\]</p><p>References for the hyperbolized Serre-Green-Naghdi system can be found in</p><ul><li>Favrie and Gavrilyuk. A rapid numerical method for solving Serre-Green-Naghdi equations describing long free surface gravity waves <a href="https://doi.org/10.1088/1361-6544/aa712d">DOI: 10.1088/1361-6544/aa712d</a></li><li>Busto, Dumbser, Escalante, Favrie, and Gavrilyuk. On High Order ADER Discontinuous Galerkin Schemes for First Order Hyperbolic Reformulations of Nonlinear Dispersive Systems <a href="https://doi.org/10.1007/s10915-021-01429-8">DOI: 10.1007/s10915-021-01429-8</a></li></ul><p>The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total modified energy</li></ul><p>for periodic boundary conditions (see Ranocha and Ricchiuto (2024)). Additionally, it is well-balanced for the lake-at-rest stationary solution, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/663b4225b73ba6d59b42b5fda0b7d1295da70b76/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L1-L85">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../basic_example/">Basic Example »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 18:54">Thursday 14 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
