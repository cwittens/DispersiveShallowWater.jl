<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Miscellaneous · DispersiveShallowWater.jl</title><meta name="title" content="Miscellaneous · DispersiveShallowWater.jl"/><meta property="og:title" content="Miscellaneous · DispersiveShallowWater.jl"/><meta property="twitter:title" content="Miscellaneous · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/miscellaneous/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/miscellaneous/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/miscellaneous/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../relaxation/">Relaxation</a></li><li><a class="tocitem" href="../dingemans/">Dingemans</a></li><li><a class="tocitem" href="../development/">Development</a></li><li class="is-active"><a class="tocitem" href>Miscellaneous</a><ul class="internal"><li><a class="tocitem" href="#eq_overview"><span>Equation Capabilities Overview</span></a></li><li><a class="tocitem" href="#Variable-Descriptions"><span>Variable Descriptions</span></a></li><li><a class="tocitem" href="#AnalysisCallback-(maybe-put-it-somewhere-else-but-not-in-overview!)"><span>AnalysisCallback (maybe put it somewhere else but not in overview!)</span></a></li><li><a class="tocitem" href="#conversion-functions"><span>conversion functions</span></a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../ref-trixibase/">TrixiBase</a></li><li><a class="tocitem" href="../ref/">DispersiveShallowWater</a></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Miscellaneous</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Miscellaneous</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/miscellaneous.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Miscellaneous"><a class="docs-heading-anchor" href="#Miscellaneous">Miscellaneous</a><a id="Miscellaneous-1"></a><a class="docs-heading-anchor-permalink" href="#Miscellaneous" title="Permalink"></a></h1><h2 id="eq_overview"><a class="docs-heading-anchor" href="#eq_overview">Equation Capabilities Overview</a><a id="eq_overview-1"></a><a class="docs-heading-anchor-permalink" href="#eq_overview" title="Permalink"></a></h2><p>The following table provides an overview of the supported features for each equation type in DispersiveShallowWater.jl:</p><table><tr><th style="text-align: right">Equation</th><th style="text-align: center">Variables</th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.boundary_condition_periodic">Periodic boundary conditions</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.boundary_condition_reflecting">Reflecting boundary conditions</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.bathymetry_flat">Flat Bathymetry</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.bathymetry_mild_slope">Mild-slope Bathymetry</a></th><th style="text-align: center"><a href="../ref/#DispersiveShallowWater.bathymetry_variable">Variable Bathymetry</a></th><th style="text-align: center">Relaxation</th><th style="text-align: center">Source Terms</th></tr><tr><td style="text-align: right"><a href="../ref/#DispersiveShallowWater.BBMEquation1D"><code>BBM</code></a></td><td style="text-align: center"><span>$(\eta)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="../ref/#DispersiveShallowWater.BBMBBMEquations1D"><code>BBM-BBM</code></a></td><td style="text-align: center"><span>$(\eta, v, D)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="../ref/#DispersiveShallowWater.KdVEquation1D"><code>KdV</code></a></td><td style="text-align: center"><span>$(\eta)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="../ref/#DispersiveShallowWater.SvaerdKalischEquations1D"><code>Svärd-Kalisch</code></a></td><td style="text-align: center"><span>$(\eta, v, D)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅ᵃ</td><td style="text-align: center">❌</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="../ref/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>Serre-Green-Naghdi</code></a></td><td style="text-align: center"><span>$(\eta, v, D)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr><tr><td style="text-align: right"><a href="../ref/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>Hyperbolic SGN</code></a></td><td style="text-align: center"><span>$(\eta, v, D, w, H)$</span></td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td><td style="text-align: center">❌</td><td style="text-align: center">✅</td><td style="text-align: center">✅</td></tr></table><p><em>ᵃReflecting boundary conditions for Svärd-Kalisch equations require <code>alpha = gamma = 0</code></em></p><h2 id="Variable-Descriptions"><a class="docs-heading-anchor" href="#Variable-Descriptions">Variable Descriptions</a><a id="Variable-Descriptions-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-Descriptions" title="Permalink"></a></h2><ul><li><span>$\eta$</span>: Total water height</li><li><span>$v$</span>: Velocity in horizontal direction  </li><li><span>$D$</span>: Still-water depth</li><li><span>$w$</span>: Auxiliary variable in hyperbolic approximation (<span>$\approx -h v_x$</span>)</li><li><span>$H$</span>: Auxiliary variable in hyperbolic approximation (<span>$\approx h$</span>)</li></ul><h2 id="AnalysisCallback-(maybe-put-it-somewhere-else-but-not-in-overview!)"><a class="docs-heading-anchor" href="#AnalysisCallback-(maybe-put-it-somewhere-else-but-not-in-overview!)">AnalysisCallback (maybe put it somewhere else but not in overview!)</a><a id="AnalysisCallback-(maybe-put-it-somewhere-else-but-not-in-overview!)-1"></a><a class="docs-heading-anchor-permalink" href="#AnalysisCallback-(maybe-put-it-somewhere-else-but-not-in-overview!)" title="Permalink"></a></h2><p>And also summary_callback = SummaryCallback()?</p><p>Additionally, we can analyze the numerical solution using an <a href="../ref/#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>. The analysis includes computing the <span>$L^2$</span> error and <span>$L^\infty$</span> error of the different solution&#39;s variables compared to the initial condition (or, if available, at the same time analytical solution). Additional errors can be passed by the keyword argument <code>extra_analysis_errors</code>. Additional integral quantities that should be analyzed can be passed by keyword argument <code>extra_analysis_integrals</code>. In this example we pass the <code>conservation_error</code>, which computes the temporal change of the total amount (i.e. integral) of the different variables over time. In addition, the integrals of the total water height <span>$\eta$</span> <a href="../ref/#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a>, the <a href="../ref/#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a> and the <a href="../ref/#DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}"><code>entropy</code></a> are computed and saved for each time step. The total water height and the total velocity are linear invariants of the BBM-BBM equations, i.e. they do not change over time. The total entropy</p><p class="math-container">\[\mathcal E(t; \eta, v) = \frac{1}{2}\int_\Omega g\eta^2 + (\eta + D)v^2\textrm{d}x\]</p><p>is a nonlinear invariant and should be constant over time as well. During the simulation, the <code>AnalysisCallback</code> will print the results to the terminal.</p><pre><code class="nohighlight hljs">tspan = (0.0, 25.0)
ode = semidiscretize(semi, tspan)
analysis_callback = AnalysisCallback(semi; interval = 10,
                                     extra_analysis_errors = (:conservation_error,),
                                     extra_analysis_integrals = (waterheight_total,
                                                                 velocity, entropy),
                                     io = devnull)
callbacks = CallbackSet(analysis_callback)

saveat = range(tspan..., length = 100)
sol = solve(ode, Tsit5(), abstol = 1e-7, reltol = 1e-7,
            save_everystep = false, callback = callbacks, saveat = saveat)</code></pre><p>The errors and integrals recorded by the <code>AnalysisCallback</code> can be obtained as <code>NamedTuple</code>s by <a href="../ref/#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors(analysis_callback)</code></a> and <a href="../ref/#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals(analysis_callback)</code></a>.</p><p>Often, it is interesting to have a look at how the quantities that are recorded by the <code>AnalysisCallback</code> evolve in time. To this end, you can <code>plot</code> the <code>AnalysisCallback</code> by</p><pre><code class="nohighlight hljs">plot(analysis_callback)
savefig(&quot;analysis_callback.png&quot;) # hide
nothing # hide</code></pre><p>This creates the following figure:</p><p>analysis callback<em>analysis</em>callback.png</p><p>You can see that the linear invariants <span>$\int_\Omega\eta\textrm{d}x$</span> and <span>$\int_\Omega v\textrm{d}x$</span> are indeed conserved exactly. The entropy, however, starts growing at around <span>$t = 17$</span>  and rises up to approximately <code>5e-5</code>. This is because of the fact that, during the time integration, a nonlinear invariant is not necessarily conserved, even if the semidiscretization conserves the quantity exactly. How to obtain a fully-discrete structure-preserving numerical scheme is explained in the following section.</p><h2 id="conversion-functions"><a class="docs-heading-anchor" href="#conversion-functions">conversion functions</a><a id="conversion-functions-1"></a><a class="docs-heading-anchor-permalink" href="#conversion-functions" title="Permalink"></a></h2><p>You can also provide a <code>conversion</code> function that converts the solution. A conversion function should take the values of the primitive variables <code>q</code> at one node, and the <code>equations</code> as input and should return an <code>SVector</code> of any length as output. For a user defined conversion function, there should also exist a function <code>varnames(conversion, equations)</code> that returns a <code>Tuple</code> of the variable names used for labelling. The conversion function can, e.g., be <a href="../ref/#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>prim2cons</code></a> or <a href="../ref/#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a> if one only wants to plot the total water height. The resulting plot will have one subplot for each of the returned variables of the conversion variable. By default, the conversion function is just <a href="../ref/#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>, which computes the physical variables from the primitive ones. For most equations this is the identity, but for hyperbolic approximations like <a href="../ref/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a>, it returns a reduced set of variables (excluding auxiliary variables like <code>w</code> and <code>H</code>).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../development/">« Development</a><a class="docs-footer-nextpage" href="../ref-trixibase/">TrixiBase »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 28 July 2025 19:53">Monday 28 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
