<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SBP Operators · DispersiveShallowWater.jl</title><meta name="title" content="SBP Operators · DispersiveShallowWater.jl"/><meta property="og:title" content="SBP Operators · DispersiveShallowWater.jl"/><meta property="twitter:title" content="SBP Operators · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/SBP_solver/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/SBP_solver/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/SBP_solver/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../relaxation/">Relaxation</a></li><li><a class="tocitem" href="../dingemans/">Dingemans</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><a class="tocitem" href="../miscellaneous/">Miscellaneous</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../ref-trixibase/">TrixiBase</a></li><li><a class="tocitem" href="../ref/">DispersiveShallowWater</a></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SBP Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SBP Operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/SBP_solver.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SBP-Operators"><a class="docs-heading-anchor" href="#SBP-Operators">SBP Operators</a><a id="SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#SBP-Operators" title="Permalink"></a></h1><p>how do SPB Operators work... </p><h1 id="SBP-Operators-2"><a class="docs-heading-anchor" href="#SBP-Operators-2">SBP Operators</a><a class="docs-heading-anchor-permalink" href="#SBP-Operators-2" title="Permalink"></a></h1><h2 id="1.-Introduction-and-Overview"><a class="docs-heading-anchor" href="#1.-Introduction-and-Overview">1. Introduction &amp; Overview</a><a id="1.-Introduction-and-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Introduction-and-Overview" title="Permalink"></a></h2><p>Summation-by-Parts (SBP) operators are a powerful class of numerical methods that provide a systematic way to construct stable and conservative discretizations of partial differential equations. In DispersiveShallowWater.jl, SBP operators form the backbone of all spatial discretizations, ensuring that important physical properties like mass and energy conservation are preserved at the discrete level.</p><p>The key insight behind SBP operators is that they <strong>mimic integration by parts discretely</strong>. Just as integration by parts is fundamental to many stability proofs and conservation laws in continuous analysis, SBP operators provide the discrete analog that allows us to transfer these important properties to the numerical scheme.</p><h3 id="Why-SBP-Operators-Matter"><a class="docs-heading-anchor" href="#Why-SBP-Operators-Matter">Why SBP Operators Matter</a><a id="Why-SBP-Operators-Matter-1"></a><a class="docs-heading-anchor-permalink" href="#Why-SBP-Operators-Matter" title="Permalink"></a></h3><p>For dispersive shallow water equations, maintaining physical properties like mass and energy conservation is crucial for:</p><ul><li><strong>Long-time stability</strong>: Simulations remain stable over extended time periods</li><li><strong>Physical accuracy</strong>: The discrete solution respects fundamental physical laws</li><li><strong>Robustness</strong>: Methods are less sensitive to parameter choices and grid resolution</li></ul><p>SBP operators achieve this by providing:</p><ul><li><strong>Provable stability</strong>: Mathematical guarantees about the behavior of the numerical method</li><li><strong>Exact conservation</strong>: Discrete conservation laws that hold to machine precision</li><li><strong>Flexibility</strong>: A unified framework that encompasses finite differences, finite elements, and spectral methods</li></ul><h3 id="Historical-Context"><a class="docs-heading-anchor" href="#Historical-Context">Historical Context</a><a id="Historical-Context-1"></a><a class="docs-heading-anchor-permalink" href="#Historical-Context" title="Permalink"></a></h3><p>SBP operators were originally developed for finite difference methods to provide the same stability guarantees that finite element methods naturally possess through their variational formulation. However, the framework has since been extended to encompass a much broader class of methods, making it a unifying principle in numerical analysis.</p><h2 id="2.-Mathematical-Foundation"><a class="docs-heading-anchor" href="#2.-Mathematical-Foundation">2. Mathematical Foundation</a><a id="2.-Mathematical-Foundation-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Mathematical-Foundation" title="Permalink"></a></h2><h3 id="The-Core-SBP-Property"><a class="docs-heading-anchor" href="#The-Core-SBP-Property">The Core SBP Property</a><a id="The-Core-SBP-Property-1"></a><a class="docs-heading-anchor-permalink" href="#The-Core-SBP-Property" title="Permalink"></a></h3><p>The fundamental property that defines a first-derivative SBP operator is:</p><p class="math-container">\[MD + D^T M = t_R t_R^T - t_L t_L^T\]</p><p>where:</p><ul><li><span>$D$</span> is the derivative operator (matrix)</li><li><span>$M$</span> is the symmetric, positive definite mass matrix</li><li><span>$t_L = (1,0,...,0)^T$</span> and <span>$t_R = (0,...,0,1)^T$</span> extract boundary values</li></ul><p>This property is the discrete analog of integration by parts:</p><p class="math-container">\[\int_a^b u \frac{dv}{dx} dx + \int_a^b \frac{du}{dx} v dx = u(b)v(b) - u(a)v(a)\]</p><h3 id="Understanding-the-Mass-Matrix"><a class="docs-heading-anchor" href="#Understanding-the-Mass-Matrix">Understanding the Mass Matrix</a><a id="Understanding-the-Mass-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-the-Mass-Matrix" title="Permalink"></a></h3><p>The mass matrix <span>$M$</span> approximates the continuous inner product:</p><p class="math-container">\[\langle u, v \rangle_M = u^T M v \approx \int_a^b u(x) v(x) dx\]</p><p>For the approximation to be meaningful, we require:</p><p class="math-container">\[1^T M 1 = x_{max} - x_{min}\]</p><p>This ensures that the discrete inner product correctly integrates constants.</p><h3 id="Discrete-Integration-by-Parts-in-Action"><a class="docs-heading-anchor" href="#Discrete-Integration-by-Parts-in-Action">Discrete Integration by Parts in Action</a><a id="Discrete-Integration-by-Parts-in-Action-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Integration-by-Parts-in-Action" title="Permalink"></a></h3><p>To see how this works in practice, consider computing <span>$u^T M D v$</span>:</p><p class="math-container">\[u^T M D v + u^T D^T M v = u^T t_R t_R^T v - u^T t_L t_L^T v = u_N v_N - u_1 v_1\]</p><p>This shows that:</p><p class="math-container">\[\langle u, Dv \rangle_M + \langle Du, v \rangle_M = u(x_{max})v(x_{max}) - u(x_{min})v(x_{min})\]</p><p>which is exactly the discrete analog of integration by parts!</p><h3 id="Example:-Central-Difference-Operator"><a class="docs-heading-anchor" href="#Example:-Central-Difference-Operator">Example: Central Difference Operator</a><a id="Example:-Central-Difference-Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Central-Difference-Operator" title="Permalink"></a></h3><p>A simple example is the classical second-order central difference operator on a uniform grid:</p><p class="math-container">\[D = \frac{1}{\Delta x} \begin{pmatrix}
-1 &amp; 1 &amp; &amp; &amp; \\
-1/2 &amp; 0 &amp; 1/2 &amp; &amp; \\
&amp; -1/2 &amp; 0 &amp; 1/2 &amp; \\
&amp; &amp; \ddots &amp; \ddots &amp; \ddots \\
&amp; &amp; &amp; -1 &amp; 1
\end{pmatrix}\]</p><p>with mass matrix:</p><p class="math-container">\[M = \Delta x \cdot \text{diag}(1/2, 1, 1, \ldots, 1, 1/2)\]</p><p>You can verify that this satisfies the SBP property and provides second-order accuracy in the interior with first-order accuracy at the boundaries.</p><h2 id="3.-Types-of-SBP-Operators"><a class="docs-heading-anchor" href="#3.-Types-of-SBP-Operators">3. Types of SBP Operators</a><a id="3.-Types-of-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Types-of-SBP-Operators" title="Permalink"></a></h2><h3 id="Central-vs.-Upwind-SBP-Operators"><a class="docs-heading-anchor" href="#Central-vs.-Upwind-SBP-Operators">Central vs. Upwind SBP Operators</a><a id="Central-vs.-Upwind-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Central-vs.-Upwind-SBP-Operators" title="Permalink"></a></h3><p>The choice between central and upwind SBP operators is crucial and depends on the nature of your problem.</p><h4 id="Central-SBP-Operators"><a class="docs-heading-anchor" href="#Central-SBP-Operators">Central SBP Operators</a><a id="Central-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Central-SBP-Operators" title="Permalink"></a></h4><p>Central operators are symmetric and provide the &quot;natural&quot; discretization:</p><ul><li><strong>Best for</strong>: Advection-dominated problems, hyperbolic systems</li><li><strong>Properties</strong>: Conservative, minimal dissipation</li><li><strong>Stencil</strong>: Symmetric around each point</li><li><strong>Drawback</strong>: Can suffer from spurious oscillations in certain contexts</li></ul><h4 id="Upwind-SBP-Operators"><a class="docs-heading-anchor" href="#Upwind-SBP-Operators">Upwind SBP Operators</a><a id="Upwind-SBP-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Upwind-SBP-Operators" title="Permalink"></a></h4><p>Upwind operators come in pairs <span>$D_+$</span> and <span>$D_-$</span> with additional dissipation:</p><ul><li><strong>Key Property</strong>: <span>$M(D_+ - D_-)$</span> is negative semidefinite (provides controlled dissipation)</li><li><strong>Best for</strong>: Parabolic/elliptic problems, diffusion-dominated systems</li><li><strong>Major Advantage</strong>: <strong>Higher resolution</strong> - better at resolving sharp features</li><li><strong>Construction</strong>: <span>$D = (D_+ + D_-)/2$</span> gives the central operator</li></ul><h4 id="Why-Upwind-Operators-Have-Higher-Resolution"><a class="docs-heading-anchor" href="#Why-Upwind-Operators-Have-Higher-Resolution">Why Upwind Operators Have Higher Resolution</a><a id="Why-Upwind-Operators-Have-Higher-Resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Upwind-Operators-Have-Higher-Resolution" title="Permalink"></a></h4><p>The resolution advantage comes from the stencil structure. Consider discretizing a second derivative:</p><p><strong>Central approach</strong> (like BR1 method):</p><pre><code class="nohighlight hljs">(D²u)ᵢ ≈ (uᵢ₊₂ - 2uᵢ + uᵢ₋₂)/(4Δx²)  [Wide stencil!]</code></pre><p>This wide stencil has <strong>grid oscillations</strong> of the form <span>$(-1,+1,-1,+1,...)$</span> in its null space.</p><p><strong>Upwind approach</strong> (like LDG method):</p><pre><code class="nohighlight hljs">(D²u)ᵢ ≈ (uᵢ₊₁ - 2uᵢ + uᵢ₋₁)/Δx²     [Narrow stencil!]</code></pre><p>The narrow stencil naturally damps high-frequency oscillations, leading to <strong>better resolution</strong>.</p><h3 id="Different-SBP-Implementations"><a class="docs-heading-anchor" href="#Different-SBP-Implementations">Different SBP Implementations</a><a id="Different-SBP-Implementations-1"></a><a class="docs-heading-anchor-permalink" href="#Different-SBP-Implementations" title="Permalink"></a></h3><h4 id="Finite-Difference-(FD)-SBP"><a class="docs-heading-anchor" href="#Finite-Difference-(FD)-SBP">Finite Difference (FD) SBP</a><a id="Finite-Difference-(FD)-SBP-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Difference-(FD)-SBP" title="Permalink"></a></h4><ul><li><strong>Grid</strong>: Uniform or non-uniform node distributions</li><li><strong>Mass matrix</strong>: Usually diagonal (especially on uniform grids)</li><li><strong>Accuracy</strong>: Limited by stencil width</li><li><strong>Best for</strong>: Simple geometries, high efficiency</li></ul><h4 id="Discontinuous-Galerkin-(DG)-SBP"><a class="docs-heading-anchor" href="#Discontinuous-Galerkin-(DG)-SBP">Discontinuous Galerkin (DG) SBP</a><a id="Discontinuous-Galerkin-(DG)-SBP-1"></a><a class="docs-heading-anchor-permalink" href="#Discontinuous-Galerkin-(DG)-SBP" title="Permalink"></a></h4><ul><li><strong>Grid</strong>: Elements with high-order polynomials within each element</li><li><strong>Mass matrix</strong>: Block diagonal (one block per element)</li><li><strong>Accuracy</strong>: Very high order possible</li><li><strong>Best for</strong>: Complex geometries, hp-adaptivity</li><li><strong>Special feature</strong>: Natural upwind operators through numerical fluxes</li></ul><h4 id="Continuous-Galerkin-(CG)-SBP"><a class="docs-heading-anchor" href="#Continuous-Galerkin-(CG)-SBP">Continuous Galerkin (CG) SBP</a><a id="Continuous-Galerkin-(CG)-SBP-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-Galerkin-(CG)-SBP" title="Permalink"></a></h4><ul><li><strong>Grid</strong>: Continuous finite element basis</li><li><strong>Mass matrix</strong>: Sparse but not diagonal</li><li><strong>Accuracy</strong>: High order with fewer degrees of freedom than DG</li><li><strong>Best for</strong>: Smooth solutions, memory efficiency</li></ul><h4 id="Fourier/Spectral-SBP"><a class="docs-heading-anchor" href="#Fourier/Spectral-SBP">Fourier/Spectral SBP</a><a id="Fourier/Spectral-SBP-1"></a><a class="docs-heading-anchor-permalink" href="#Fourier/Spectral-SBP" title="Permalink"></a></h4><ul><li><strong>Grid</strong>: Fourier modes or other orthogonal polynomials</li><li><strong>Mass matrix</strong>: Often identity or diagonal in spectral space</li><li><strong>Accuracy</strong>: Exponential convergence for smooth periodic problems</li><li><strong>Best for</strong>: Problems with high regularity and periodic boundaries</li></ul><h3 id="Choosing-the-Right-Operator-Type"><a class="docs-heading-anchor" href="#Choosing-the-Right-Operator-Type">Choosing the Right Operator Type</a><a id="Choosing-the-Right-Operator-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-the-Right-Operator-Type" title="Permalink"></a></h3><table><tr><th style="text-align: right">Problem Type</th><th style="text-align: right">Recommended Operator</th><th style="text-align: right">Reason</th></tr><tr><td style="text-align: right">Wave propagation</td><td style="text-align: right">Central FD/DG</td><td style="text-align: right">Minimal dissipation preserves waves</td></tr><tr><td style="text-align: right">Diffusion/Heat equation</td><td style="text-align: right">Upwind DG</td><td style="text-align: right">Better resolution of boundary layers</td></tr><tr><td style="text-align: right">Shock-dominated flows</td><td style="text-align: right">Upwind DG with limiters</td><td style="text-align: right">Handles discontinuities</td></tr><tr><td style="text-align: right">Periodic smooth solutions</td><td style="text-align: right">Fourier</td><td style="text-align: right">Spectral accuracy</td></tr><tr><td style="text-align: right">Complex geometries</td><td style="text-align: right">DG</td><td style="text-align: right">Geometric flexibility</td></tr></table><h3 id="Resolution-Comparison-Example"><a class="docs-heading-anchor" href="#Resolution-Comparison-Example">Resolution Comparison Example</a><a id="Resolution-Comparison-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Resolution-Comparison-Example" title="Permalink"></a></h3><p>Here&#39;s a simple comparison showing the resolution difference:</p><pre><code class="language-julia hljs"># Central operators - may have oscillations
solver_central = Solver(mesh, 4)  # Uses central differences

# Upwind operators - higher resolution
using SummationByPartsOperators: couple_discontinuously, PeriodicUpwindOperators
D_legendre = legendre_derivative_operator(-1.0, 1.0, 4)
uniform_mesh = UniformPeriodicMesh1D(xmin, xmax, div(N, 4))
minus = couple_discontinuously(D_legendre, uniform_mesh, Val(:minus))
plus = couple_discontinuously(D_legendre, uniform_mesh, Val(:plus))
central = couple_discontinuously(D_legendre, uniform_mesh)

D1 = PeriodicUpwindOperators(minus, central, plus)
D2 = sparse(plus) * sparse(minus)  # Creates narrow-stencil second derivative
solver_upwind = Solver(D1, D2)</code></pre><p>The upwind solver will typically provide sharper resolution of features like wave fronts and boundary layers, at the cost of slightly more computational work per time step.</p><h2 id="customize_solver"><a class="docs-heading-anchor" href="#customize_solver">Customize solver</a><a id="customize_solver-1"></a><a class="docs-heading-anchor-permalink" href="#customize_solver" title="Permalink"></a></h2><p>In the semidiscretization created above, we used the default SBP operators, which are periodic finite difference operators. Using different SBP operators for the semidiscretization can be done leveraging <a href="https://github.com/ranocha/SummationByPartsOperators.jl/">SummationByPartsOperators.jl</a>, which needs to be imported first:</p><pre><code class="nohighlight hljs">using SummationByPartsOperators: legendre_derivative_operator, UniformPeriodicMesh1D, couple_discontinuously, PeriodicUpwindOperators</code></pre><p>As an example, let us create a semidiscretization based on discontinuous Galerkin (DG) upwind operators. A semidiscretization implemented in DispersiveShallowWater.jl needs one first-derivative and one second-derivative SBP operator. To build the first-derivative operator, we first create a <code>LegendreDerivativeOperator</code> with polynomial degree 3 on a reference element <code>[-1.0, 1.0]</code> and a <code>UniformPeriodicMesh1D</code> for the coupling.</p><pre><code class="nohighlight hljs">mesh = Mesh1D(coordinates_min, coordinates_max, N)
accuracy_order = 4
D_legendre = legendre_derivative_operator(-1.0, 1.0, accuracy_order)
uniform_mesh = UniformPeriodicMesh1D(mesh.xmin, mesh.xmax, div(mesh.N, accuracy_order))</code></pre><p>Upwind DG operators in negative, central and positive operators can be obtained by <code>couple_discontinuously</code></p><pre><code class="nohighlight hljs">central = couple_discontinuously(D_legendre, uniform_mesh)
minus = couple_discontinuously(D_legendre, uniform_mesh, Val(:minus))
plus = couple_discontinuously(D_legendre, uniform_mesh, Val(:plus))
D1 = PeriodicUpwindOperators(minus, central, plus)</code></pre><p>In order to still have an entropy-conserving semidiscretization the second-derivative SBP operator needs to be</p><pre><code class="nohighlight hljs">using SparseArrays: sparse
D2 = sparse(plus) * sparse(minus)</code></pre><p>The <a href="../ref/#Solver"><code>Solver</code></a> object can now be created by passing the two SBP operators to the constructor, which, in turn, can be used to construct a <code>Semidiscretization</code>:</p><pre><code class="nohighlight hljs">solver = Solver(D1, D2)
semi = Semidiscretization(mesh, equations, initial_condition, solver, boundary_conditions = boundary_conditions)</code></pre><p>As before, we can run the simulation by</p><pre><code class="nohighlight hljs">analysis_callback = AnalysisCallback(semi; interval = 10,
                                     extra_analysis_errors = (:conservation_error,),
                                     extra_analysis_integrals = (waterheight_total,
                                                                 velocity, entropy),
                                     io = devnull)
relaxation_callback = RelaxationCallback(invariant = entropy)
callbacks = CallbackSet(relaxation_callback, analysis_callback)
sol = solve(ode, Tsit5(), abstol = 1e-7, reltol = 1e-7,
            save_everystep = false, callback = callbacks, saveat = saveat)
anim = @animate for step in 1:length(sol.u)
    plot(semi =&gt; sol, plot_initial = true, conversion = waterheight_total, step = step, xlim = (-50, 20), ylims = (-0.8, 0.1))
end
gif(anim, &quot;shoaling_solution_dg.gif&quot;, fps = 25)
nothing # hide</code></pre><p>shoaling solution DG<em>shoaling</em>solution_dg.gif</p><p>For more details see also the <a href="https://ranocha.de/SummationByPartsOperators.jl/stable/">documentation of SummationByPartsOperators.jl</a></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 29 July 2025 10:55">Tuesday 29 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
