<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · DispersiveShallowWater.jl</title><meta name="title" content="Reference · DispersiveShallowWater.jl"/><meta property="og:title" content="Reference · DispersiveShallowWater.jl"/><meta property="twitter:title" content="Reference · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/ref/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/ref/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/ref/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../basic_example/">Basic Example</a></li><li><a class="tocitem" href="../SBP_Operators/">Summation-by-Parts Operators</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../solvers/">Using Different Solvers</a></li><li><a class="tocitem" href="../callbacks/">Callbacks and Relaxation</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../dingemans/">Experimental Data</a></li><li><a class="tocitem" href="../development/">Development</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Model-specific-equations"><span>Model specific equations</span></a></li><li><a class="tocitem" href="#Linear-dispersion-relations"><span>Linear dispersion relations</span></a></li><li><a class="tocitem" href="#Mesh"><span>Mesh</span></a></li><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li><li><a class="tocitem" href="#Solver"><span>Solver</span></a></li><li><a class="tocitem" href="#Semidiscretization"><span>Semidiscretization</span></a></li><li><a class="tocitem" href="#Callbacks"><span>Callbacks</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/ref.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="DispersiveShallowWater.jl-API"><a class="docs-heading-anchor" href="#DispersiveShallowWater.jl-API">DispersiveShallowWater.jl API</a><a id="DispersiveShallowWater.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#DispersiveShallowWater.jl-API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.DispersiveShallowWater" href="#DispersiveShallowWater.DispersiveShallowWater"><code>DispersiveShallowWater.DispersiveShallowWater</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater</code></pre><p><strong>DispersiveShallowWater.jl</strong> is a Julia package that implements structure-preserving numerical methods for dispersive shallow water models. It provides provably conservative, entropy-conserving, and well-balanced numerical schemes for some dispersive shallow water models.</p><p>The semidiscretizations are based on summation-by-parts (SBP) operators, which are implemented in <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a>. To obtain fully discrete schemes, the time integration methods from <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> are used to solve the resulting ordinary differential equations. Fully discrete entropy-conservative methods can be obtained by using the relaxation method provided by DispersiveShallowWater.jl.</p><p>See also: <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl">DispersiveShallowWater.jl</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/DispersiveShallowWater.jl#L1-L15">source</a></section></article><h2 id="Model-specific-equations"><a class="docs-heading-anchor" href="#Model-specific-equations">Model specific equations</a><a id="Model-specific-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Model-specific-equations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total_modified!(e, q_global, equations::BBMEquation1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="../overview/#DispersiveShallowWater.BBMEquation1D"><code>BBMEquation1D</code></a>. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>It is given by</p><p class="math-container">\[\frac{1}{2} \eta(\eta - \frac{1}{6}D^2\eta_{xx}).\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_1d.jl#L193-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.hamiltonian!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hamiltonian!(H, q_global, equations::BBMEquation1D, cache)</code></pre><p>Return the Hamiltonian <code>H</code> of the primitive variables <code>q_global</code> for the <a href="../overview/#DispersiveShallowWater.BBMEquation1D"><code>BBMEquation1D</code></a>. The Hamiltonian is given by</p><p class="math-container">\[\frac{1}{4}\sqrt{\frac{g}{D}}\eta^3 + \frac{1}{2}\sqrt{gD}\eta^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes.</p><p>See also <a href="#DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>hamiltonian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_1d.jl#L226-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::BBMEquation1D, mesh)</code></pre><p>A traveling-wave solution used for convergence tests in a periodic domain, here generalized for dimensional variables.</p><p>See section 4.1.3 in (there is an error in paper: it should be <code>sech^2</code> instead of <code>cosh</code>):</p><ul><li>Hendrik Ranocha, Dimitrios Mitsotakis and David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_1d.jl#L56-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::BBMEquation1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_1d.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::BBMEquation1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_1d.jl#L93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A traveling-wave solution used for convergence tests in a periodic domain. The bathymetry is constant.</p><p>For details see Example 5 in Section 3 from (here adapted for dimensional equations):</p><ul><li>Min Chen (1997) Exact Traveling-Wave Solutions to Bidirectional Wave Equations <a href="https://doi.org/10.1023/A:1026667903256">DOI: 10.1023/A:1026667903256</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_bbm_1d.jl#L67-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_dingemans</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_dingemans(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>The initial condition that uses the dispersion relation of the Euler equations to approximate waves generated by a wave maker as it is done by experiments of Dingemans. The topography is a trapezoidal.</p><div class="admonition is-warning" id="Translation-of-water-height-cd07bf62a533b073"><header class="admonition-header">Translation of water height<a class="admonition-anchor" href="#Translation-of-water-height-cd07bf62a533b073" title="Permalink"></a></header><div class="admonition-body"><p>The initial condition for the water height is translated to be around 0, which is needed for the simulation because the <code>BBMBBMEquations1D</code> are only implemented for <span>$\eta_0 = 0$</span>.</p></div></div><p>References:</p><ul><li>Magnus Svärd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Maarten W. Dingemans (1994) Comparison of computations with Boussinesq-like models and laboratory measurements <a href="https://repository.tudelft.nl/islandora/object/uuid:c2091d53-f455-48af-a84b-ac86680455e9/datastream/OBJ/download">link</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_bbm_1d.jl#L226-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_bbm_1d.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_bbm_1d.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::BBMBBMEquations1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_bbm_1d.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::BBMBBMEquations1D)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/bbm_bbm_1d.jl#L182-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_flat" href="#DispersiveShallowWater.bathymetry_flat"><code>DispersiveShallowWater.bathymetry_flat</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry_flat = DispersiveShallowWater.BathymetryFlat()</code></pre><p>A singleton struct indicating a flat bathymetry.</p><p>See also <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a> and <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L509-L515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_mild_slope" href="#DispersiveShallowWater.bathymetry_mild_slope"><code>DispersiveShallowWater.bathymetry_mild_slope</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry_mild_slope = DispersiveShallowWater.BathymetryMildSlope()</code></pre><p>A singleton struct indicating a variable bathymetry with mild-slope approximation. Typically, this means that some terms like <span>$b_x^2$</span> are neglected.</p><p>See also <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> and <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L519-L527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_variable" href="#DispersiveShallowWater.bathymetry_variable"><code>DispersiveShallowWater.bathymetry_variable</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry_variable = DispersiveShallowWater.BathymetryVariable()</code></pre><p>A singleton struct indicating a variable bathymetry (without mild-slope approximation).</p><p>See also <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> and <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L531-L538">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractEquations" href="#DispersiveShallowWater.AbstractEquations"><code>DispersiveShallowWater.AbstractEquations</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractEquations{NDIMS, NVARS}</code></pre><p>An abstract supertype of specific equations such as the BBM-BBM equations. The type parameters encode the number of spatial dimensions (<code>NDIMS</code>) and the number of primary variables (<code>NVARS</code>) of the physics model.</p><p>See also <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractShallowWaterEquations" href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>DispersiveShallowWater.AbstractShallowWaterEquations</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractShallowWaterEquations{NDIMS, NVARS}</code></pre><p>An abstract supertype of all equation system that contain the classical shallow water equations as a subsystem, e.g., the <a href="../overview/#DispersiveShallowWater.BBMBBMEquations1D"><code>BBMBBMEquations1D</code></a>, the <a href="../overview/#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a>, and the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. In 1D, the shallow water equations with flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x &amp;= 0,
\end{aligned}\]</p><p>where <span>$h$</span> is the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a>, <span>$v$</span> the <a href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a>, and <span>$g$</span> the <a href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>gravity</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L25-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.bathymetry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry(q, equations)</code></pre><p>Return the bathymetry of the primitive variables <code>q</code> for a given set of <code>equations</code>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L230-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.cons2prim-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.cons2prim-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.cons2prim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cons2prim(u, equations)</code></pre><p>Convert the conserved variables <code>u</code> to the primitive variables for a given set of <code>equations</code>. <code>u</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct. The inverse conversion is performed by <a href="#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>prim2cons</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L114-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_analysis_errors-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.default_analysis_errors-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.default_analysis_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_analysis_errors(equations)</code></pre><p>Default analysis errors used by the <a href="#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L437-L441">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_analysis_integrals-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.default_analysis_integrals-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.default_analysis_integrals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_analysis_integrals(equations)</code></pre><p>Default analysis integrals used by the <a href="#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L444-L448">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.discharge-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.discharge-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.discharge</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">discharge(q, equations)</code></pre><p>See <a href="#DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>momentum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.eachvariable-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.eachvariable-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.eachvariable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachvariable(equations::AbstractEquations)</code></pre><p>Return an iterator over the indices that specify the location in relevant data structures for the variables in <code>equations</code>. In particular, not the variables themselves are returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.energy_total</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total(q, equations)</code></pre><p>Return the total energy of the primitive variables <code>q</code> for a given set of <code>equations</code>. For all <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>, the total energy is given by the sum of the kinetic and potential energy of the shallow water subsystem, i.e.,</p><p class="math-container">\[\frac{1}{2} h v^2 + \frac{1}{2} g \eta^2\]</p><p>in 1D, where <span>$h$</span> is the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a>, <span>$\eta = h + b$</span> the <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a>, <span>$v$</span> the <a href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a>, and <span>$g$</span> the <a href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>gravity</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L268-L284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total_modified!(e, q_global, equations, cache)</code></pre><p>In-place version of <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L338-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.energy_total_modified</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total_modified(q_global, equations, cache)</code></pre><p>Return the modified total energy of the primitive variables <code>q_global</code> for the <code>equations</code>. This modified total energy is a conserved quantity and can contain additional terms compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>. For example, for the <a href="../overview/#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a> and the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>, it contains additional terms depending on the derivative of the velocity <span>$v_x$</span> modeling non-hydrostatic contributions. For equations which are not <code>AbstractShallowWaterEquations</code>, the modified total energy does not have to be an extension of the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> and does not have to be related to a physical energy. However, it is still a conserved quantity for appropriate boundary conditions and may contain derivatives of the solution.</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code> if non-hydrostatic terms are present.</p><p>Internally, this function allocates a vector for the output and calls <a href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L311-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.entropy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy(q, equations)</code></pre><p>Return the entropy of the primitive variables <code>q</code> for a given set of <code>equations</code>. For all <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>, the <code>entropy</code> is just the <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L294-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy_modified!-NTuple{4, Any}" href="#DispersiveShallowWater.entropy_modified!-NTuple{4, Any}"><code>DispersiveShallowWater.entropy_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy_modified!(e, q_global, equations, cache)</code></pre><p>In-place version of <a href="#DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>entropy_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L367-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.entropy_modified</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy_modified(q_global, equations, cache)</code></pre><p>Alias for <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L357-L361">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.get_name-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.get_name-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.get_name</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_name(equations::AbstractEquations)</code></pre><p>Return the canonical, human-readable name for the given system of equations.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; DispersiveShallowWater.get_name(BBMBBMEquations1D(gravity=1.0))
&quot;BBMBBMEquations1D-BathymetryVariable&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L45-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.gravity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gravity(equations)</code></pre><p>Return the gravitational acceleration <span>$g$</span> for a given set of <code>equations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L259-L263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.hamiltonian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hamiltonian(q_global, equations, cache)</code></pre><p>Return the Hamiltonian of the primitive variables <code>q_global</code> for the <code>equations</code>. The Hamiltonian is a conserved quantity and may contain derivatives of the solution.</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code> if non-hydrostatic terms are present.</p><p>Internally, this function allocates a vector for the output and calls <a href="#DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.hamiltonian!</code></a>.</p><div class="admonition is-info" id="Note-aea7c321837f0b32"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-aea7c321837f0b32" title="Permalink"></a></header><div class="admonition-body"><p>This function is not necessarily implemented for all equations. See <a href="#DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.hamiltonian!</code></a> for further details of equations supporting it.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L380-L398">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.hyperbolic_approximation_limit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.hyperbolic_approximation_limit(equations)</code></pre><p>If the equations are a hyperbolic approximation of another set of equations, return the equations of the limit system. Otherwise, return the input equations.</p><p>See also <a href="#DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}"><code>is_hyperbolic_appproximation</code></a> and <a href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>.</p><div class="admonition is-info" id="Implementation-details-3fc727817cb8e6d"><header class="admonition-header">Implementation details<a class="admonition-anchor" href="#Implementation-details-3fc727817cb8e6d" title="Permalink"></a></header><div class="admonition-body"><p>This function is mostly used for some internal dispatch. For example, it allows to return a reduced set of variables from initial conditions for hyperbolic approximations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L468-L480">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, AbstractShallowWaterEquations, Any}" href="#DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, AbstractShallowWaterEquations, Any}"><code>DispersiveShallowWater.initial_condition_dingemans</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_dingemans(x, t, equations::AbstractShallowWaterEquations, mesh)</code></pre><p>The initial condition that uses the dispersion relation of the Euler equations to approximate waves generated by a wave maker as it is done by experiments of Dingemans. The topography is a trapezoidal. It is assumed that <code>equations.eta0 = 0.8</code>.</p><p>References:</p><ul><li>Magnus Svärd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Maarten W. Dingemans (1994) Comparison of computations with Boussinesq-like models and laboratory measurements <a href="https://repository.tudelft.nl/islandora/object/uuid:c2091d53-f455-48af-a84b-ac86680455e9/datastream/OBJ/download">link</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L617-L631">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_discontinuous_well_balancedness-Tuple{Any, Any, AbstractShallowWaterEquations, Any}" href="#DispersiveShallowWater.initial_condition_discontinuous_well_balancedness-Tuple{Any, Any, AbstractShallowWaterEquations, Any}"><code>DispersiveShallowWater.initial_condition_discontinuous_well_balancedness</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_discontinuous_well_balancedness(x, t, equations::AbstractShallowWaterEquations, mesh)</code></pre><p>Setup a truly discontinuous bottom topography function for this academic lake-at-rest test case of well-balancedness, i.e. <code>eta</code> is constant and <code>v</code> is zero everywhere. The error for this lake-at-rest test case <code>∫|η-η₀|</code> should be around machine roundoff.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L659-L666">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.is_hyperbolic_appproximation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.is_hyperbolic_appproximation(equations)</code></pre><p>Returns <code>Val{true}()</code> if the equations are a hyperbolic approximation of another set of equations and <code>Val{false}()</code> otherwise (default). For example, the <a href="../overview/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a> are a hyperbolic approximation of the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>.</p><p>See also <a href="#DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}"><code>hyperbolic_approximation_limit</code></a> and <a href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>.</p><div class="admonition is-info" id="Implementation-details-3fc727817cb8e6d"><header class="admonition-header">Implementation details<a class="admonition-anchor" href="#Implementation-details-3fc727817cb8e6d" title="Permalink"></a></header><div class="admonition-body"><p>This function is mostly used for some internal dispatch. For example, it allows to return a reduced set of variables from initial conditions for hyperbolic approximations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L451-L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.lake_at_rest_error-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.lake_at_rest_error-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.lake_at_rest_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lake_at_rest_error(q, equations)</code></pre><p>Calculate the error for the &quot;lake-at-rest&quot; test case where the <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a> <span>$\eta = h + b$</span> should be a constant value over time (given by the value <span>$\eta_0$</span> passed to the <code>equations</code> when constructing them).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L245-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.momentum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">momentum(q, equations)</code></pre><p>Return the momentum/discharge of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a> times the <a href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L190-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.prim2cons</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2cons(q, equations)</code></pre><p>Convert the primitive variables <code>q</code> to the conserved variables for a given set of <code>equations</code>. <code>q</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct. The inverse conversion is performed by <a href="#DispersiveShallowWater.cons2prim-Tuple{Any, AbstractShallowWaterEquations}"><code>cons2prim</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L88-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.prim2phys</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2phys(q, equations)</code></pre><p>Convert the primitive variables <code>q</code> to the physically meaningful variables for a given set of <code>equations</code>. By default, this is the same as <a href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2prim</code></a> for most equations. However, some equations like the <a href="../overview/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a> return a reduced set of variables since they are a hyperbolic approximation of another set of equations (in this case the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>).</p><p>See also <a href="#DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}"><code>is_hyperbolic_appproximation</code></a> and <a href="#DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}"><code>hyperbolic_approximation_limit</code></a>.</p><p><code>q</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L483-L499">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.prim2prim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2prim(q, equations)</code></pre><p>Return the primitive variables <code>q</code>. While this function is as trivial as <code>identity</code>, it is also as useful.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L77-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.still_water_surface-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.still_water_surface-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.still_water_surface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">still_water_surface(q, equations)</code></pre><p>Return the still water surface <span>$\eta_0$</span> (lake at rest) for a given set of <code>equations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L214-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.varnames" href="#DispersiveShallowWater.varnames"><code>DispersiveShallowWater.varnames</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">varnames(conversion_function, equations)</code></pre><p>Return the list of variable names when applying <code>conversion_function</code> to the primitive variables associated to <code>equations</code>. Common choices of the <code>conversion_function</code> are <a href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2prim</code></a>, <a href="#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>prim2cons</code></a>, and <a href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L67-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.velocity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">velocity(q, equations)</code></pre><p>Return the velocity of the primitive variables <code>q</code> for a given set of <code>equations</code>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L175-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.waterheight</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waterheight(q, equations)</code></pre><p>Return the waterheight of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the waterheight <span>$h$</span> above the bathymetry <span>$b$</span>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p><p>See also <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a>, <a href="#DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>bathymetry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L158-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.waterheight_total</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waterheight_total(q, equations)</code></pre><p>Return the total waterheight of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a> <span>$h$</span> plus the <a href="#DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>bathymetry</code></a> <span>$b$</span>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/equations.jl#L142-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.energy_total_modified!(e, q_global, equations::HyperbolicSerreGreenNaghdiEquations1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="../overview/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a>. It contains additional terms compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>For a <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a> (and a <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>), the total modified energy is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 +
\frac{1}{6} h w^2 + \frac{\lambda}{6} h (1 - \eta / h)^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L520-L539">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::HyperbolicSerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L194-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::HyperbolicSerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L250-L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_soliton</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_soliton(x, t, equations::HyperbolicSerreGreenNaghdiEquations1D, mesh)</code></pre><p>A soliton solution of the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> used for convergence tests in a periodic domain. This is physically the same as <a href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_convergence_test</code></a> for the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. Please note that this is not an exact solution of the <a href="../overview/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a> (only in the limit of the relaxation parameter <span>$\lambda \to \infty$</span>).</p><p>See also <a href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L158-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2phys-Tuple{Any, HyperbolicSerreGreenNaghdiEquations1D}" href="#DispersiveShallowWater.prim2phys-Tuple{Any, HyperbolicSerreGreenNaghdiEquations1D}"><code>DispersiveShallowWater.prim2phys</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2phys(q, equations::HyperbolicSerreGreenNaghdiEquations1D)</code></pre><p>Return the physical variables <span>$\eta, v, D$</span> used also by the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> from the main variables <code>q</code> for the <a href="../overview/#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L110-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, HyperbolicSerreGreenNaghdiEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, HyperbolicSerreGreenNaghdiEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::HyperbolicSerreGreenNaghdiEquations1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L218-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, HyperbolicSerreGreenNaghdiEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, HyperbolicSerreGreenNaghdiEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::HyperbolicSerreGreenNaghdiEquations1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p><p>calculated as shown in: https://github.com/NumericalMathematics/DispersiveShallowWater.jl/pull/228#issuecomment-3123350726</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L275-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total-Tuple{Any, KdVEquation1D}" href="#DispersiveShallowWater.energy_total-Tuple{Any, KdVEquation1D}"><code>DispersiveShallowWater.energy_total</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total(q, equations::KdVEquation1D)</code></pre><p>Return the total energy of the primitive variables <code>q</code> for the <a href="../overview/#DispersiveShallowWater.KdVEquation1D"><code>KdVEquation1D</code></a>. For the KdV equation, the total energy consists only of the potential energy, given by</p><p class="math-container">\[\frac{1}{2} g \eta^2\]</p><p>where <span>$\eta$</span> is the <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a> and <span>$g$</span> is the <a href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>gravity</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of length 1 in this case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L272-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy-Tuple{Any, KdVEquation1D}" href="#DispersiveShallowWater.entropy-Tuple{Any, KdVEquation1D}"><code>DispersiveShallowWater.entropy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy(q, equations::KdVEquation1D)</code></pre><p>Return the entropy of the primitive variables <code>q</code> for the <a href="../overview/#DispersiveShallowWater.KdVEquation1D"><code>KdVEquation1D</code></a>. For the KdV equation, the <code>entropy</code> is the same as the <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of length 1 in this case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L292-L300">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, KdVEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, KdVEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::KdVEquation1D, mesh)</code></pre><p>A soliton solution used for convergence tests in a periodic domain. Same as <a href="#DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>initial_condition_soliton</code></a> for the <a href="../overview/#DispersiveShallowWater.KdVEquation1D"><code>KdVEquation1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, KdVEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, KdVEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::KdVEquation1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, KdVEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, KdVEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_soliton</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_soliton(x, t, equations::KdVEquation1D, mesh)</code></pre><p>A classical soliton solution of the KdV equation in dimensional variables. This can be used for convergence tests in a periodic domain, see <a href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L56-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.nondim2prim-Tuple{Any, KdVEquation1D}" href="#DispersiveShallowWater.nondim2prim-Tuple{Any, KdVEquation1D}"><code>DispersiveShallowWater.nondim2prim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nondim2prim(u, equations::KdVEquation1D)</code></pre><p>Convert the non-dimensional variable <code>u</code> to the primitive/physical variable <code>eta</code> (total water height) for the <a href="../overview/#DispersiveShallowWater.KdVEquation1D"><code>KdVEquation1D</code></a>.</p><p>The transformation is given by:</p><p class="math-container">\[\eta = D(u - \frac{2}{3})\]</p><p>where <code>D</code> is the still-water depth.</p><div class="admonition is-warning" id="Parameter-constraints-7985069a26cf831a"><header class="admonition-header">Parameter constraints<a class="admonition-anchor" href="#Parameter-constraints-7985069a26cf831a" title="Permalink"></a></header><div class="admonition-body"><p>This conversion is only valid for equations with specific parameter values:</p><ul><li><code>gravity = 4/27</code> </li><li><code>D = 3.0</code> </li></ul><p>These values ensure the dimensional KdV equation matches the standard  non-dimensional form <code>u_t + u u_x + u_{xxx} = 0</code>.</p></div></div><p>This function allows converting solutions from the standard non-dimensional  KdV form commonly found in literature to the dimensional form implemented  in DispersiveShallowWater.jl.</p><p>See also <a href="#DispersiveShallowWater.prim2nondim-Tuple{Any, KdVEquation1D}"><code>prim2nondim</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L122-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2nondim-Tuple{Any, KdVEquation1D}" href="#DispersiveShallowWater.prim2nondim-Tuple{Any, KdVEquation1D}"><code>DispersiveShallowWater.prim2nondim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2nondim(eta, equations::KdVEquation1D)</code></pre><p>Convert the primitive/physical variable <code>eta</code> (total water height) to the  non-dimensional variable <code>u</code> for the <a href="../overview/#DispersiveShallowWater.KdVEquation1D"><code>KdVEquation1D</code></a>.</p><p>The transformation is given by:</p><p class="math-container">\[u = \frac{\eta}{D} + \frac{2}{3}\]</p><p>where <code>D</code> is the still-water depth.</p><div class="admonition is-warning" id="Parameter-constraints-d8f29dff421978da"><header class="admonition-header">Parameter constraints<a class="admonition-anchor" href="#Parameter-constraints-d8f29dff421978da" title="Permalink"></a></header><div class="admonition-body"><p>This conversion is only valid for equations with specific parameter values:</p><ul><li><code>gravity = 4/27</code> </li><li><code>D = 3.0</code></li></ul><p>These values ensure the dimensional KdV equation matches the standard  non-dimensional form <code>u_t + u u_x + u_{xxx} = 0</code>.</p></div></div><p>This function allows converting solutions from the dimensional form implemented  in DispersiveShallowWater.jl to the standard non-dimensional KdV form  commonly found in literature, enabling comparison with theoretical results  and other implementations.</p><p>See also <a href="#DispersiveShallowWater.nondim2prim-Tuple{Any, KdVEquation1D}"><code>nondim2prim</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L153-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, KdVEquation1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, KdVEquation1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::KdVEquation1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p><p>How it was calculated, is described in: https://github.com/NumericalMathematics/DispersiveShallowWater.jl/pull/198#discussion_r2090805751</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L96-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.varnames-Tuple{typeof(prim2nondim), KdVEquation1D}" href="#DispersiveShallowWater.varnames-Tuple{typeof(prim2nondim), KdVEquation1D}"><code>DispersiveShallowWater.varnames</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">varnames(::typeof(prim2nondim), equations::KdVEquation1D)</code></pre><p>Return variable names <code>(&quot;u&quot;,)</code> for non-dimensional KdV variables when plotting with <code>conversion = prim2nondim</code>.</p><p>See <a href="#DispersiveShallowWater.prim2nondim-Tuple{Any, KdVEquation1D}"><code>prim2nondim</code></a>, <a href="#DispersiveShallowWater.varnames"><code>varnames</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/kdv_1d.jl#L185-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.energy_total_modified!(e, q_global, equations::SerreGreenNaghdiEquations1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. It contains an additional term containing a derivative compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>For a <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> the total modified energy is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 + \frac{1}{6} h^3 v_x^2.\]</p><p>For a <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a> the total modified energy is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 + \frac{1}{6} h (-h v_x + 1.5 v b_x)^2.\]</p><p>For a <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a> the total modified energy has the additional term</p><p class="math-container">\[+ \frac{1}{8} h (v b_x)^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L1350-L1377">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A soliton solution used for convergence tests in a periodic domain. Same as <a href="#DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>initial_condition_soliton</code></a> for the <a href="../overview/#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L109-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p><p><strong>References for flat bathymetry</strong></p><ul><li>D. Mitsotakis, C. Synolakis, and M. McGuinness (2016) A modified Galerkin/finite element method for the numerical solution of the Serre-Green-Naghdi system. <a href="https://doi.org/10.1002/fld.4293">DOI: 10.1002/fld.4293</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L277-L289">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_soliton</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_soliton(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A classical soliton solution of the Serre-Green-Naghdi equations. This can be used for convergence tests in a periodic domain, see <a href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SerreGreenNaghdiEquations1D{DispersiveShallowWater.BathymetryFlat}}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SerreGreenNaghdiEquations1D{DispersiveShallowWater.BathymetryFlat}}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::SerreGreenNaghdiEquations1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L158-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, SerreGreenNaghdiEquations1D{DispersiveShallowWater.BathymetryFlat}}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, SerreGreenNaghdiEquations1D{DispersiveShallowWater.BathymetryFlat}}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::SerreGreenNaghdiEquations1D)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/serre_green_naghdi_1d.jl#L342-L347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.energy_total_modified!(e, q_global, equations::SvaerdKalischEquations1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="../overview/#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a>. It contains an additional term containing a derivative compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>It is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 + \frac{1}{2} \hat\beta v_x^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/svaerd_kalisch_1d.jl#L507-L525">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/svaerd_kalisch_1d.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/svaerd_kalisch_1d.jl#L149-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SvaerdKalischEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SvaerdKalischEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::SvaerdKalischEquations1D)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/svaerd_kalisch_1d.jl#L86-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, SvaerdKalischEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, SvaerdKalischEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::SvaerdKalischEquations1D)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/equations/svaerd_kalisch_1d.jl#L165-L170">source</a></section></article><h2 id="Linear-dispersion-relations"><a class="docs-heading-anchor" href="#Linear-dispersion-relations">Linear dispersion relations</a><a id="Linear-dispersion-relations-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-dispersion-relations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.EulerEquations1D" href="#DispersiveShallowWater.EulerEquations1D"><code>DispersiveShallowWater.EulerEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EulerEquations1D(; gravity, eta0 = 0.0)</code></pre><p>A struct representing the 1D Euler equations with a given gravitational acceleration <code>gravity</code> and a still-water surface <code>eta0</code>.</p><div class="admonition is-info" id="Note-d3cd7562a53b7f87"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d3cd7562a53b7f87" title="Permalink"></a></header><div class="admonition-body"><p>In DispersiveShallowWater.jl, the Euler equations are <em>only</em> used for computing the full linear dispersion relation</p><p class="math-container">\[\omega(k) = \sqrt{g k \tanh(h_0 k)},\]</p><p>see <a href="#DispersiveShallowWater.LinearDispersionRelation"><code>LinearDispersionRelation</code></a> and <a href="#DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}"><code>wave_speed</code></a>. The <code>EulerEquations1D</code> cannot be solved as a system of equations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/dispersion_relation.jl#L43-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.LinearDispersionRelation" href="#DispersiveShallowWater.LinearDispersionRelation"><code>DispersiveShallowWater.LinearDispersionRelation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearDispersionRelation(ref_height)</code></pre><p>A struct representing a linear dispersion relation <span>$\omega(k)$</span> of an equation. The reference water height <span>$h_0$</span> is given by <code>ref_height</code>. A dispersion relation can be called as <code>disp_rel(equations, k)</code> to compute the wave frequency <span>$\omega(k)$</span> for a given wavenumber <code>k</code> and a set of equations.</p><p>See also <a href="#DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}"><code>wave_speed</code></a> for computing the wave speed <span>$c = \omega(k) / k$</span> given a linear dispersion relation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/dispersion_relation.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}" href="#DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}"><code>DispersiveShallowWater.wave_speed</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wave_speed(disp_rel, equations, k; normalize = false)</code></pre><p>Compute the wave speed <span>$c$</span> for a given wavenumber <span>$k$</span> using the <a href="#DispersiveShallowWater.LinearDispersionRelation"><code>LinearDispersionRelation</code></a> <code>disp_rel</code> of the <code>equations</code>. The wave speed is given by <span>$c = \omega(k) / k$</span>. If <code>normalize</code> is <code>true</code>, the wave speed is normalized by the shallow water wave speed <span>$\sqrt{g h_0}$</span>, where <span>$g$</span> is the gravitational acceleration of the <code>equations</code> and <span>$h_0$</span> is the <code>ref_height</code> of the dispersion relation <code>disp_rel</code>.</p><p>See also <a href="#DispersiveShallowWater.LinearDispersionRelation"><code>LinearDispersionRelation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/dispersion_relation.jl#L22-L32">source</a></section></article><h2 id="Mesh"><a class="docs-heading-anchor" href="#Mesh">Mesh</a><a id="Mesh-1"></a><a class="docs-heading-anchor-permalink" href="#Mesh" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Mesh1D" href="#DispersiveShallowWater.Mesh1D"><code>DispersiveShallowWater.Mesh1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Mesh1D</code></pre><p>Struct that holds the information for a simple homogeneous one-dimensional mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/mesh.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Mesh1D-Tuple{Any, Any, Any}" href="#DispersiveShallowWater.Mesh1D-Tuple{Any, Any, Any}"><code>DispersiveShallowWater.Mesh1D</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Mesh1D(xmin, xmax, N)</code></pre><p>Create a simple homogeneous one-dimensional mesh from <code>xmin</code> to <code>xmax</code> with <code>N</code> nodes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/mesh.jl#L18-L22">source</a></section></article><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.boundary_condition_periodic" href="#DispersiveShallowWater.boundary_condition_periodic"><code>DispersiveShallowWater.boundary_condition_periodic</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_condition_periodic = DispersiveShallowWater.BoundaryConditionPeriodic()</code></pre><p>A singleton struct indicating periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/boundary_conditions.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.boundary_condition_reflecting" href="#DispersiveShallowWater.boundary_condition_reflecting"><code>DispersiveShallowWater.boundary_condition_reflecting</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_condition_reflecting = DispersiveShallowWater.BoundaryConditionReflecting()</code></pre><p>A singleton struct indicating reflecting boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/boundary_conditions.jl#L13-L16">source</a></section></article><h2 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractSolver" href="#DispersiveShallowWater.AbstractSolver"><code>DispersiveShallowWater.AbstractSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSolver</code></pre><p>An abstract supertype of specific solvers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/solver.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver" href="#DispersiveShallowWater.Solver"><code>DispersiveShallowWater.Solver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver</code></pre><p>A <code>struct</code> that holds the summation-by-parts (SBP) operators that are used for the spatial discretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/solver.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver-Tuple{Any, Any}" href="#DispersiveShallowWater.Solver-Tuple{Any, Any}"><code>DispersiveShallowWater.Solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver(mesh, accuracy_order)</code></pre><p>Create a solver, where the three summation-by-parts (SBP) first-, second-, and third-derivative operators are of accuracy order <code>accuracy_order</code> and associated to the <code>mesh</code>.</p><div class="admonition is-warning" id="Periodic-operators-only-afa0310568e7dd45"><header class="admonition-header">Periodic operators only<a class="admonition-anchor" href="#Periodic-operators-only-afa0310568e7dd45" title="Permalink"></a></header><div class="admonition-body"><p>This constructor creates periodic derivative operators that are only compatible with periodic  boundary conditions. For non-periodic boundary conditions, use the <code>Solver(D1, D2, D3)</code>  constructor with appropriate non-periodic operators (or <code>nothing</code>).</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/solver.jl#L53-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver-Union{Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}}, Tuple{RealT}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}} where RealT" href="#DispersiveShallowWater.Solver-Union{Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}}, Tuple{RealT}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}} where RealT"><code>DispersiveShallowWater.Solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver(D1, D2 = nothing, D3 = nothing)</code></pre><p>Create a solver, where <code>D1</code> is an <code>AbstractDerivativeOperator</code> from <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a> of first <code>derivative_order</code>, <code>D2</code> is an <code>AbstractDerivativeOperator</code>  of second <code>derivative_order</code> or an <code>AbstractMatrix</code>, and <code>D3</code> is an <code>AbstractDerivativeOperator</code> of third <code>derivative_order</code> or an <code>AbstractMatrix</code>. <code>D2</code> and <code>D3</code> can also be <code>nothing</code> if that derivative is not used by the discretization. All given summation-by-parts operators should be associated with the same grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/solver.jl#L76-L86">source</a></section></article><h2 id="Semidiscretization"><a class="docs-heading-anchor" href="#Semidiscretization">Semidiscretization</a><a id="Semidiscretization-1"></a><a class="docs-heading-anchor-permalink" href="#Semidiscretization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Semidiscretization" href="#DispersiveShallowWater.Semidiscretization"><code>DispersiveShallowWater.Semidiscretization</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Semidiscretization</code></pre><p>A <code>struct</code> containing everything needed to describe a spatial semidiscretization of an equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/semidiscretization.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Semidiscretization-NTuple{4, Any}" href="#DispersiveShallowWater.Semidiscretization-NTuple{4, Any}"><code>DispersiveShallowWater.Semidiscretization</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Semidiscretization(mesh, equations, initial_condition, solver;
                   source_terms=nothing,
                   boundary_conditions=boundary_condition_periodic,
                   RealT=real(solver),
                   uEltype=RealT,
                   initial_cache = (tmp1 = Array{RealT}(undef, nnodes(mesh)),
                                    tmp_partitioned = allocate_coefficients(mesh, equations, solver)))</code></pre><p>Construct a semidiscretization of a PDE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/semidiscretization.jl#L43-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.jacobian-Tuple{Semidiscretization}" href="#DispersiveShallowWater.jacobian-Tuple{Semidiscretization}"><code>DispersiveShallowWater.jacobian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.jacobian(semi::Semidiscretization;
                                t = 0.0,
                                q0 = compute_coefficients(semi.initial_condition, t, semi))</code></pre><p>Use the right-hand side operator of the semidiscretization <code>semi</code> and forward mode automatic differentiation to compute the Jacobian <code>J</code> of the semidiscretization <code>semi</code> at the state <code>q0</code>.</p><div class="admonition is-warning" id="Warning-828ee3ecc1693904"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-828ee3ecc1693904" title="Permalink"></a></header><div class="admonition-body"><p>This functionality may not be implemented for all equations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/semidiscretization.jl#L243-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PolynomialBases.grid-Tuple{Semidiscretization}" href="#PolynomialBases.grid-Tuple{Semidiscretization}"><code>PolynomialBases.grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grid(semi)</code></pre><p>Get the grid of a semidiscretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/semidiscretization.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SummationByPartsOperators.semidiscretize-Tuple{Semidiscretization, Any}" href="#SummationByPartsOperators.semidiscretize-Tuple{Semidiscretization, Any}"><code>SummationByPartsOperators.semidiscretize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">semidiscretize(semi::Semidiscretization, tspan)</code></pre><p>Wrap the semidiscretization <code>semi</code> as an ODE problem in the time interval <code>tspan</code> that can be passed to <code>solve</code> from the <a href="https://diffeq.sciml.ai/latest/">SciML ecosystem</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/semidiscretization.jl#L230-L235">source</a></section></article><h2 id="Callbacks"><a class="docs-heading-anchor" href="#Callbacks">Callbacks</a><a id="Callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Callbacks" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AnalysisCallback" href="#DispersiveShallowWater.AnalysisCallback"><code>DispersiveShallowWater.AnalysisCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AnalysisCallback(semi; interval=0,
                       extra_analysis_errors=Symbol[],
                       extra_analysis_integrals=(),
                       io=stdout)</code></pre><p>Analyze a numerical solution every <code>interval</code> time steps. The L2- and the L∞-norm for each component are computed by default. Additional errors can be computed, e.g. by passing <code>extra_analysis_errors = (:conservation_error,)</code>.</p><p>Further scalar functions <code>func</code> in <code>extra_analysis_integrals</code> are applied to the numerical solution and integrated over the computational domain. Some examples for this are <a href="#DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}"><code>entropy</code></a>, and <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>. You can also write your own function with the same signature as the examples listed above and pass it via <code>extra_analysis_integrals</code>. The computed errors and intergrals are saved for each timestep and can be obtained by calling <a href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors</code></a> and <a href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals</code></a>.</p><p>During the Simulation, the <code>AnalysisCallback</code> will print information to <code>io</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/callbacks_step/analysis.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">errors(analysis_callback)</code></pre><p>Return the computed errors for each timestep as a named tuple. The shape of each entry is (nvariables, ntimesteps).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/callbacks_step/analysis.jl#L117-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.integrals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrals(analysis_callback)</code></pre><p>Return the computed integrals for each timestep as a named tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/callbacks_step/analysis.jl#L136-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.tstops-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.tstops-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.tstops</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tstops(analysis_callback)</code></pre><p>Return the time values that correspond to the saved values of the <a href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors</code></a> and <a href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/callbacks_step/analysis.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.RelaxationCallback" href="#DispersiveShallowWater.RelaxationCallback"><code>DispersiveShallowWater.RelaxationCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RelaxationCallback(invariant)</code></pre><p>Use a relaxation method in time in order to exactly preserve the (nonlinear) <code>invariant</code> for a conservative semidiscretization. A possible choice for <code>invariant</code> is <code>invariant = entropy</code>.</p><p>Reference</p><ul><li>Hendrik Ranocha, Mohammed Sayyari, Lisandro Dalcin, Matteo Parsani, David I. Ketcheson (2020) Relaxation Runge–Kutta Methods: Fully-Discrete Explicit Entropy-Stable Schemes for the Compressible Euler and Navier–Stokes Equations <a href="https://doi.org/10.1137/19M1263480">DOI: 10.1137/19M1263480</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/callbacks_step/relaxation.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SummaryCallback" href="#DispersiveShallowWater.SummaryCallback"><code>DispersiveShallowWater.SummaryCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SummaryCallback(io::IO = stdout)</code></pre><p>Create and return a callback that resets the timer at the beginning of a simulation and prints the timer values at the end of the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/callbacks_step/summary.jl#L1-L6">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><h3 id="Utilities-from-DispersiveShallowWater.jl"><a class="docs-heading-anchor" href="#Utilities-from-DispersiveShallowWater.jl">Utilities from DispersiveShallowWater.jl</a><a id="Utilities-from-DispersiveShallowWater.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities-from-DispersiveShallowWater.jl" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.convergence_test-Tuple{Module, AbstractString, Any}" href="#DispersiveShallowWater.convergence_test-Tuple{Module, AbstractString, Any}"><code>DispersiveShallowWater.convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convergence_test([mod::Module=Main,] example::AbstractString, iterations; io::IO = stdout, kwargs...)
convergence_test([mod::Module=Main,] example::AbstractString, Ns::AbstractVector; io::IO = stdout, kwargs...)</code></pre><p>Run multiple simulations using the setup given in <code>example</code> and compute the experimental order of convergence (EOC) in the <span>$L^2$</span> and <span>$L^\infty$</span> norm. If <code>iterations</code> is passed as integer, in each iteration, the resolution of the respective mesh will be doubled. If <code>Ns</code> is passed as vector, the simulations will be run for each value of <code>Ns</code>. Additional keyword arguments <code>kwargs...</code> and the optional module <code>mod</code> are passed directly to <a href="#TrixiBase.trixi_include-Tuple{Function, Module, AbstractString}"><code>trixi_include</code></a>.</p><p>Adjusted from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/util.jl#L54-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_example-Tuple{}" href="#DispersiveShallowWater.default_example-Tuple{}"><code>DispersiveShallowWater.default_example</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_example()</code></pre><p>Return the path to an example that can be used to quickly see DispersiveShallowWater.jl in action. See also <a href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>examples_dir</code></a> and <a href="#DispersiveShallowWater.get_examples-Tuple{}"><code>get_examples</code></a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/util.jl#L38-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.examples_dir-Tuple{}" href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>DispersiveShallowWater.examples_dir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">examples_dir()</code></pre><p>Return the directory where the example files provided with DispersiveShallowWater.jl are located. If DispersiveShallowWater is installed as a regular package (with <code>]add DispersiveShallowWater</code>), these files are read-only and should <em>not</em> be modified. To find out which files are available, use, e.g., <code>readdir</code>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">readdir(examples_dir())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/util.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.get_examples-Tuple{}" href="#DispersiveShallowWater.get_examples-Tuple{}"><code>DispersiveShallowWater.get_examples</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_examples()</code></pre><p>Return a list of all examples that are provided by DispersiveShallowWater.jl. See also <a href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>examples_dir</code></a> and <a href="#DispersiveShallowWater.default_example-Tuple{}"><code>default_example</code></a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/util.jl#L17-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.@autoinfiltrate" href="#DispersiveShallowWater.@autoinfiltrate"><code>DispersiveShallowWater.@autoinfiltrate</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@autoinfiltrate
@autoinfiltrate condition::Bool</code></pre><p>Invoke the <code>@infiltrate</code> macro of the package Infiltrator.jl to create a breakpoint for ad-hoc interactive debugging in the REPL. If the optional argument <code>condition</code> is given, the breakpoint is only enabled if <code>condition</code> evaluates to <code>true</code>.</p><p>As opposed to using <code>Infiltrator.@infiltrate</code> directly, this macro does not require Infiltrator.jl to be added as a dependency to DispersiveShallowWater.jl. As a bonus, the macro will also attempt to load the Infiltrator module if it has not yet been loaded manually.</p><p>Note: For this macro to work, the Infiltrator.jl package needs to be installed in your current Julia environment stack.</p><p>See also: <a href="https://github.com/JuliaDebug/Infiltrator.jl">Infiltrator.jl</a></p><div class="admonition is-warning" id="Internal-use-only-d1e58a3a7fb5517"><header class="admonition-header">Internal use only<a class="admonition-anchor" href="#Internal-use-only-d1e58a3a7fb5517" title="Permalink"></a></header><div class="admonition-body"><p>Please note that this macro is intended for internal use only. It is <em>not</em> part of the public API of DispersiveShallowWater.jl, and it thus can altered (or be removed) at any time without it being considered a breaking change.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/a8ea8cdf5e43748af83158c6b50c38eafeb5d7ca/src/util.jl#L193-L214">source</a></section></article><h3 id="Utilities-from-TrixiBase.jl"><a class="docs-heading-anchor" href="#Utilities-from-TrixiBase.jl">Utilities from TrixiBase.jl</a><a id="Utilities-from-TrixiBase.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities-from-TrixiBase.jl" title="Permalink"></a></h3><p>Be aware that only <code>trixi_include</code> is being exported from DispersiveShallowWater.jl. To access the other TrixiBase functions, you need to either:</p><ul><li>Use the fully qualified name: <code>DispersiveShallowWater.timer()</code>, <code>DispersiveShallowWater.@trixi_timeit</code>, etc.</li><li>Import TrixiBase explicitly: <code>using TrixiBase</code> or <code>import TrixiBase</code></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiBase.disable_debug_timings-Tuple{}" href="#TrixiBase.disable_debug_timings-Tuple{}"><code>TrixiBase.disable_debug_timings</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">disable_debug_timings()</code></pre><p>Disable all <a href="#TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}"><code>@trixi_timeit</code></a> timings. The timings should be optimized away, allowing for truly zero-overhead. Enable timings again with <a href="#TrixiBase.enable_debug_timings-Tuple{}"><code>enable_debug_timings</code></a>.</p><p>See also <a href="#TrixiBase.enable_debug_timings-Tuple{}"><code>enable_debug_timings</code></a>, <a href="#TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}"><code>@trixi_timeit</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiBase.jl/blob/v0.1.6/src/trixi_timeit.jl#L8-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiBase.enable_debug_timings-Tuple{}" href="#TrixiBase.enable_debug_timings-Tuple{}"><code>TrixiBase.enable_debug_timings</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">enable_debug_timings()</code></pre><p>Enable all <a href="#TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}"><code>@trixi_timeit</code></a> timings (default behavior).</p><p>See also <a href="#TrixiBase.disable_debug_timings-Tuple{}"><code>disable_debug_timings</code></a>, <a href="#TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}"><code>@trixi_timeit</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiBase.jl/blob/v0.1.6/src/trixi_timeit.jl#L19-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiBase.timer-Tuple{}" href="#TrixiBase.timer-Tuple{}"><code>TrixiBase.timer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">timer()</code></pre><p>Main timer for global timing, e.g., to be used with <a href="#TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}"><code>@trixi_timeit</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiBase.jl/blob/v0.1.6/src/trixi_timeit.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiBase.trixi_include-Tuple{Function, Module, AbstractString}" href="#TrixiBase.trixi_include-Tuple{Function, Module, AbstractString}"><code>TrixiBase.trixi_include</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trixi_include([mapexpr::Function=identity,] [mod::Module=Main,] elixir::AbstractString; kwargs...)</code></pre><p><code>include</code> the file <code>elixir</code> and evaluate its content in the global scope of module <code>mod</code>. You can override specific assignments in <code>elixir</code> by supplying keyword arguments. Its basic purpose is to make it easier to modify some parameters while running simulations from the REPL. Additionally, this is used in tests to reduce the computational burden for CI while still providing examples with sensible default values for users.</p><p>Before replacing assignments in <code>elixir</code>, the keyword argument <code>maxiters</code> is inserted into calls to <code>solve</code> with it&#39;s default value used in the SciML ecosystem for ODEs, see the &quot;Miscellaneous&quot; section of the <a href="https://docs.sciml.ai/DiffEqDocs/stable/basics/common_solver_opts/">documentation</a>.</p><p>The optional first argument <code>mapexpr</code> can be used to transform the included code before it is evaluated: for each parsed expression <code>expr</code> in <code>elixir</code>, the <code>include</code> function actually evaluates <code>mapexpr(expr)</code>. If it is omitted, <code>mapexpr</code> defaults to <code>identity</code>.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">julia&gt; using TrixiBase, Trixi

julia&gt; redirect_stdout(devnull) do
         trixi_include(@__MODULE__, joinpath(examples_dir(), &quot;tree_1d_dgsem&quot;, &quot;elixir_advection_extended.jl&quot;),
                       tspan=(0.0, 0.1))
         sol.t[end]
       end
[ Info: You just called `trixi_include`. Julia may now compile the code, please be patient.
0.1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiBase.jl/blob/v0.1.6/src/trixi_include.jl#L5-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiBase.trixi_include_changeprecision-Tuple{Any, Module, AbstractString}" href="#TrixiBase.trixi_include_changeprecision-Tuple{Any, Module, AbstractString}"><code>TrixiBase.trixi_include_changeprecision</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trixi_include_changeprecision(T, [mod::Module=Main,] elixir::AbstractString; kwargs...)</code></pre><p><code>include</code> the elixir <code>elixir</code> and evaluate its content in the global scope of module <code>mod</code>. You can override specific assignments in <code>elixir</code> by supplying keyword arguments, similar to <a href="#TrixiBase.trixi_include-Tuple{Function, Module, AbstractString}"><code>trixi_include</code></a>.</p><p>The only difference to <a href="#TrixiBase.trixi_include-Tuple{Function, Module, AbstractString}"><code>trixi_include</code></a> is that the precision of floating-point numbers in the included elixir is changed to <code>T</code>. More precisely, the package <a href="https://github.com/JuliaMath/ChangePrecision.jl">ChangePrecision.jl</a> is used to convert all <code>Float64</code> literals, operations like <code>/</code> that produce <code>Float64</code> results, and functions like <code>ones</code> that return <code>Float64</code> arrays by default, to the desired type <code>T</code>. See the documentation of ChangePrecision.jl for more details.</p><p>The purpose of this function is to conveniently run a full simulation with <code>Float32</code>, which is orders of magnitude faster on most GPUs than <code>Float64</code>, by just including the elixir with <code>trixi_include_changeprecision(Float32, elixir)</code>. Many constructors in the Trixi.jl framework are written in a way that changing all floating-point arguments to <code>Float32</code> will change the element type to <code>Float32</code> as well. In TrixiParticles.jl, including an elixir with this macro should be sufficient to run the full simulation with single precision.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiBase.jl/blob/v0.1.6/src/trixi_include.jl#L64-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}" href="#TrixiBase.@trixi_timeit-Tuple{Any, Any, Any}"><code>TrixiBase.@trixi_timeit</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@trixi_timeit timer() &quot;some label&quot; expression</code></pre><p>Basically the same as a special case of <code>@timeit_debug</code> from <a href="https://github.com/KristofferC/TimerOutputs.jl">TimerOutputs.jl</a>, but without <code>try ... finally ... end</code> block. Thus, it&#39;s not exception-safe, but it also avoids some related performance problems. Since we do not use exception handling in Trixi.jl, that&#39;s not really an issue.</p><p>All <code>@trixi_timeit</code> timings can be disabled with <a href="#TrixiBase.disable_debug_timings-Tuple{}"><code>disable_debug_timings</code></a>. The timings should then be optimized away, allowing for truly zero-overhead.</p><p>See also <a href="#TrixiBase.disable_debug_timings-Tuple{}"><code>disable_debug_timings</code></a>, <a href="#TrixiBase.enable_debug_timings-Tuple{}"><code>enable_debug_timings</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiBase.jl/blob/v0.1.6/src/trixi_timeit.jl#L39-L52">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../development/">« Development</a><a class="docs-footer-nextpage" href="../changelog/">Changelog »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 22 August 2025 08:04">Friday 22 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
